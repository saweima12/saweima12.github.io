<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../../../logo.png" />
		<link rel="sitemap" type="application/xml" href="/sitemap.xml" />
		<link rel="alternate" type="application/atom+xml" href="/atom.xml" />
		<link rel="alternate" type="application/feed+xml" href="/feed.xml" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta http-equiv="content-security-policy" content=""><title>Sanic - è¼•é‡å¿«é€Ÿçš„ Python Web Framework - Saweicore Lab - ç¨‹å¼é–‹ç™¼ | ç¶²ç«™æ¶è¨­ | å¹£åœˆé›œè«‡ | å„é …é›œç‡´é›†æ•£åœ°</title><meta name="twitter:card" content="summary" data-svelte="svelte-f1lzu5"><meta name="twitter:site" content="@saweima12" data-svelte="svelte-f1lzu5"><meta name="twitter:title" content="Sanic - è¼•é‡å¿«é€Ÿçš„ Python Web Framework - Saweicore Lab - ç¨‹å¼é–‹ç™¼ | ç¶²ç«™æ¶è¨­ | å¹£åœˆé›œè«‡ | å„é …é›œç‡´é›†æ•£åœ°" data-svelte="svelte-f1lzu5"><meta name="twitter:description" data-svelte="svelte-f1lzu5"><meta name="twitter:url" content="https://saweicore.com/posts/2022/08/sanic-introduce" data-svelte="svelte-f1lzu5"><meta property="og:url" content="https://saweicore.com/posts/2022/08/sanic-introduce" data-svelte="svelte-f1lzu5"><meta property="og:locale" content="zh_TW" data-svelte="svelte-f1lzu5"><meta property="og:type" content="article" data-svelte="svelte-f1lzu5"><meta property="og:title" content="Sanic - è¼•é‡å¿«é€Ÿçš„ Python Web Framework" data-svelte="svelte-f1lzu5"><meta property="og:site_name" content="Saweicore Lab - ç¨‹å¼é–‹ç™¼ | ç¶²ç«™æ¶è¨­ | å¹£åœˆé›œè«‡ | å„é …é›œç‡´é›†æ•£åœ°" data-svelte="svelte-f1lzu5"><meta property="og:description" content="ä¸€æ¬¾æ”¯æ´éåŒæ­¥èª¿ç”¨ä¸é˜»å¡åŸ·è¡Œç·’ã€ç·¨å¯«é¢¨æ ¼ç°¡æ½”ä¸æ‹–æ³¥å¸¶æ°´ã€å…§ç½®é«˜æ•ˆç‡ä¼ºæœå™¨æ–¹ä¾¿éƒ¨ç½²çš„ Python æ¡†æ¶ï¼Œé©åˆç”¨æ–¼å¿«é€Ÿé–‹ç™¼ä¸­å°å‹å°ˆæ¡ˆã€‚" data-svelte="svelte-f1lzu5">
		<meta name="description" content="ä¸€æ¬¾æ”¯æ´éåŒæ­¥èª¿ç”¨ä¸é˜»å¡åŸ·è¡Œç·’ã€ç·¨å¯«é¢¨æ ¼ç°¡æ½”ä¸æ‹–æ³¥å¸¶æ°´ã€å…§ç½®é«˜æ•ˆç‡ä¼ºæœå™¨æ–¹ä¾¿éƒ¨ç½²çš„ Python æ¡†æ¶ï¼Œé©åˆç”¨æ–¼å¿«é€Ÿé–‹ç™¼ä¸­å°å‹å°ˆæ¡ˆã€‚" data-svelte="svelte-f1lzu5">
	<link href="../../../_app/immutable/assets/+layout-eed564a7.css" rel="stylesheet">
	<link href="../../../_app/immutable/assets/+page-7ed394ec.css" rel="stylesheet">
	<link rel="modulepreload" href="../../../_app/immutable/start-34fd70cd.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/index-e6965666.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/index-e127beab.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/preload-helper-aa6bc0ce.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/singletons-dbe501d2.js">
	<link rel="modulepreload" href="../../../_app/immutable/components/pages/_layout.svelte-db83af4e.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/store-465521c3.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/helper-a645ffda.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/stores-4922191d.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/navigation-a14b4e4e.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/_commonjsHelpers-094ef602.js">
	<link rel="modulepreload" href="../../../_app/immutable/modules/pages/_layout.ts-4774ee04.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/route-58ec6f73.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/_layout-5a184ceb.js">
	<link rel="modulepreload" href="../../../_app/immutable/components/pages/posts/_year_/_month_/_slug_/_page.svelte-d45c6961.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/formater-faf389fa.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/calender-ce03e571.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/colors-e3ddc188.js">
	<link rel="modulepreload" href="../../../_app/immutable/modules/pages/posts/_year_/_month_/_slug_/_page.ts-8ee2144c.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/_page-a23fdb74.js">
	</head>
	<body>
		<div>


<div class="wrapper-container"><div class="transition-all duration-200 min-h-screen main-wrapper"><div class="fixed top-0 w-screen wrapper">

<nav class="py-2 px-2 top-navbar svelte-1jv9zmu"><div class="flex pl-1 items-center navbar-container svelte-1jv9zmu"><div class="lg:hidden w-30 px-2"><div class="menu-button-wrapper"><div class="menu-button-container"><div class="menu-button"></div></div></div></div>

		<a sveltekit:prefetch class="flex raleway-font site-title" href="/"><div class="logo svelte-1jv9zmu"><img width="36" height="36" src="/logo.png" alt="Saweicore Lab"></div>
			
			<div class="hidden md:flex px-2 letter-title-font title svelte-1jv9zmu">Saweicore Lab</div></a>
	
		<div class="grow spacer"></div>

		<div class="hidden lg:flex items-center"><ul class="h-full flex flex-row nav-list svelte-1jv9zmu"><li class="nav-item mr-5 px-2 svelte-1jv9zmu"><a sveltekit:prefetch href="/journal" alt="" class="w-full h-full"><div class="flex items-center nav-item-block svelte-1jv9zmu"><div class="item-name">Journal</div>
							</div>
					</a>
				</li><li class="nav-item mr-5 px-2 svelte-1jv9zmu"><a sveltekit:prefetch href="/about" alt="" class="w-full h-full"><div class="flex items-center nav-item-block svelte-1jv9zmu"><div class="item-name">About</div>
							</div>
					</a>
				</li><li class="nav-item mr-5 px-2 svelte-1jv9zmu"><a href="http://github.com/saweima12" alt="" class="w-full h-full"><div class="flex items-center nav-item-block svelte-1jv9zmu"><div class="item-name">Github</div>
							<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div>
					</a>
				</li></ul>
			<button class="flex text-xl letter-content-font mr-1 theme-switch svelte-1jv9zmu"><div class="icon-base w-6"><svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>ic_fluent_dark_theme_24_filled</title><desc>Created with Sketch.</desc><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill="#212121" fill-rule="nonzero"><path fill="currentColor" d="M12,22 C17.5228475,22 22,17.5228475 22,12 C22,6.4771525 17.5228475,2 12,2 C6.4771525,2 2,6.4771525 2,12 C2,17.5228475 6.4771525,22 12,22 Z M12,20 L12,4 C16.418278,4 20,7.581722 20,12 C20,16.418278 16.418278,20 12,20 Z" id="ğŸ¨-Color"></path></g></g></svg></div></button></div>

		<div class="lg:hidden search-icon"><div class="nav-search mr-2 svelte-18cfe79"><div class="flex self-center justify-center w-6 label-icon"><svg viewBox="0 0 24 24" aria-hidden="true" class="svelte-1h287kj"><path fill="currentColor" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"></path></svg></div>
</div></div></div>


</nav></div>

		<div class="flex flex-col justify-between main-container svelte-agtcg5"><div class="w-full content-wrapper"><main class="mx-auto min-h-screen content-container"><div>

<div class="my-10 post-page wrapper"><div class="post-container"><header class="mx-6 mb-4"><h1 class="font-bold letter-title-font post-title">Sanic - è¼•é‡å¿«é€Ÿçš„ Python Web Framework</h1>

			<div class="flex flex-row items-center mt-2 created-date"><div class="icon-base w-5"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line fill="currentColor" x1="16" y1="2" x2="16" y2="6"></line><line fill="currentColor" x1="8" y1="2" x2="8" y2="6"></line><line fill="currentColor" x1="3" y1="10" x2="21" y2="10"></line></svg></div>
				<time class="flex self-center ml-2">2022-08-08</time></div>

			<div class="mt-4 flex flex-row post-tag-list"><div class="post-tag-item"><a sveltekit:prefetch href="/tags/web">web</a>
					</div><div class="post-tag-item"><a sveltekit:prefetch href="/tags/python">python</a>
					</div><div class="post-tag-item"><a sveltekit:prefetch href="/tags/programing">programing</a>
					</div></div></header>

		<article class="content"><!-- HTML_TAG_START --><p>Sanic æ˜¯ä¸€æ¬¾ Python çš„ Web æ¡†æ¶ï¼Œç·¨å¯«é¢¨æ ¼ç¹¼æ‰¿äº†è€ç‰Œæ¡†æ¶ Flask çš„ç°¡æ½”ä¸¦åœ¨å…¶ä¹‹ä¸Šæ·»åŠ  async / await çš„éåŒæ­¥èª¿ç”¨æ”¯æ´ï¼Œå¤–åŠ å…§å»ºå¿«é€Ÿé«˜æ•ˆçš„ HTTP Serverï¼Œæä¾›äº†é–‹ç®±å³ç”¨ã€å¿«é€Ÿé–‹ç™¼ã€ç”Ÿç”¢éƒ¨ç½²çš„è§£æ±ºæ–¹æ¡ˆã€‚</p>
<blockquote>
<p><strong>Sanic</strong><br/>
å®˜æ–¹ç¶²ç«™ï¼š <a href="https://sanic.dev/" target="_blank" rel="noreferrer noopenner">é»æˆ‘é€²å…¥</a><br/></p>
</blockquote>
<p><strong>å®‰è£æ–¹å¼ï¼š</strong></p>
<pre><code class="language-sh">pip install sanic
</code></pre>
<h2 id="æ¡†æ¶ç‰¹æ€§" class="heading-item">æ¡†æ¶ç‰¹æ€§</h2><ul>
<li>ä½¿ç”¨ Python 3.8 ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼ˆæ¨è–¦ç›´æ¥ä½¿ç”¨ Python 3.10ï¼‰</li>
<li>æ”¯æ´ async / await éåŒæ­¥ç‰¹æ€§ï¼ˆåŸ·è¡Œ IO æ“ä½œæ™‚ä¸æœƒé˜»å¡ï¼‰</li>
<li>å…§å»ºå¿«é€Ÿçš„ HTTP Server </li>
<li>é¡ Flask çš„ç°¡æ½”æ¶æ§‹ï¼Œæ˜“æ–¼æ“´å……èˆ‡ç·¨å¯«ã€‚</li>
</ul>
<blockquote>
<p>ç·¨å¯«é€™é‚Šæ–‡ç« æ™‚ä½¿ç”¨çš„ç‰ˆæœ¬ç‚º <strong>22.6.1</strong>ï¼Œé€šå¸¸ä½¿ç”¨æœ€æ–°çš„ç‰ˆæœ¬å³å¯ã€‚</p>
</blockquote>
<h2 id="å»ºç«‹åŸºæœ¬çµæ§‹" class="heading-item">å»ºç«‹åŸºæœ¬çµæ§‹</h2><p>å•Ÿå‹• Sanic  çš„æ–¹å¼æœ‰ä»¥ä¸‹å…©ç¨®ï¼š</p>
<ul>
<li>é€éè…³æœ¬é‹è¡Œ -&gt; åœ¨ç·¨å¯«è…³æœ¬ä¸­ä½¿ç”¨ <code>Sanic.run()</code> é‹è¡Œã€‚</li>
<li>ä½¿ç”¨ CLI -&gt; ä½¿ç”¨ <code>Sanic CLI</code> å°‡ application ä½œç‚º module å°å…¥(<strong>æ¨è–¦</strong>)</li>
</ul>
<h3 id="é€é-apprun-é‹è¡Œ" class="heading-item">é€é app.run() é‹è¡Œ</h3><p>åœ¨æ ¹ç›®éŒ„ä¸­å»ºç«‹ app.py ï¼Œä¸¦å»ºç«‹ Sanic instanceï¼Œé€é app.run é‹è¡Œä¼ºæœå™¨ã€‚</p>
<pre><code class="language-python">from sanic import Sanic

# create sanic app
app = Sanic(__name__)

if __name__ == &#39;__main__&#39;:
        # é€é app.run é‹è¡Œ
    app.run(host=&quot;0.0.0.0&quot;, debug=True)
</code></pre>
<h3 id="é€é-cli-é‹è¡Œæ¨è–¦" class="heading-item">é€é CLI é‹è¡Œ(æ¨è–¦)</h3><p> å»ºç«‹ä»¥ä¸‹è³‡æ–™å¤¾çµæ§‹ï¼Œç•¶è³‡æ–™å¤¾å…§æœ‰ <code>__init__.py</code> æª”æ¡ˆæ™‚ï¼Œè©²è³‡æ–™å¤¾å°±æœƒè¢« python è¦–ç‚º pacakgeã€‚</p>
<pre><code class="language-text">/
â”œâ”€ sanicapp
â”‚   â””â”€  __init__.py
â””â”€ run.sh
</code></pre>
<ul>
<li><code>__init__.py</code>  ä¸­å»ºç«‹ Sanic Instance ã€‚</li>
</ul>
<pre><code class="language-python">from sanic import Sanic

# create sanic app
app = Sanic(__name__)

# __name__ å¯æ”¹ç‚ºè‡ªå®šç¾© App åç¨±
</code></pre>
<ul>
<li>æœ€å¾Œä½¿ç”¨ä»¥ä¸‹ shell æŒ‡ä»¤åŸ·è¡Œ sanic ä¼ºæœå™¨ã€‚</li>
</ul>
<pre><code class="language-shell">sanic sanicapp:app -H 0.0.0.0 -p 8080 -d
</code></pre>
<ul>
<li><code>sanicapp</code>ç‚º package çš„åç¨±ï¼Œ<code>app</code> ç‚º instance è®Šé‡ã€‚</li>
<li><code>-H</code> ç”¨æ–¼æŒ‡å®š Host Address (é è¨­ç‚º 127.0.0.1)</li>
<li><code>-p</code> ç”¨æ–¼æŒ‡å®š Port (é è¨­ç‚º 8000)</li>
<li><code>-d</code> ç”¨æ–¼é–‹å•Ÿ Debug æ¨¡å¼ï¼ˆæœƒè‡ªå‹•é‡è¼‰åŠçœ‹åˆ°æ›´è©³ç´°çš„ logï¼‰</li>
<li><code>-w</code> ç”¨æ–¼æŒ‡å®šè¦å•Ÿå‹•å¹¾å€‹ worker </li>
<li>å¯é€é <code>-h</code> åƒæ•¸è§€çœ‹è©³ç´°çš„èªªæ˜</li>
</ul>
<p>ä½¿ç”¨ CLI é‹è¡Œ Sanic ä¼ºæœå™¨å¯ä»¥åœ¨é‹è¡Œç’°å¢ƒé…ç½®ä¸Šç²å¾—æ›´å¤šçš„å½ˆæ€§ã€‚ç•¶éœ€è¦æ”¹è®Š host æˆ–æ˜¯ debug mode æ™‚ï¼Œå¯ä»¥ç›´æ¥è®Šæ›´åƒæ•¸ï¼Œä¸éœ€è¦ä¿®æ”¹è…³æœ¬çš„ app.run çš„åƒæ•¸ã€‚</p>
<h2 id="handler" class="heading-item">Handler</h2><p>Handler æ˜¯è™•ç† Request çš„åŸºæœ¬å–®å…ƒï¼Œ<strong>è‡³å°‘æœƒæ”¶åˆ°ä¸€å€‹ Reqeust ç‰©ä»¶ä¸¦ return ä¸€å€‹ HTTPResponse</strong> ã€‚</p>
<ul>
<li>Request.headers -&gt;  å–å¾—å¤¾å¸¶åœ¨ request header çš„è³‡æ–™ã€‚</li>
<li>Request.args  or Request.query_args -&gt; å–å¾— URLQueryParams</li>
<li>Request.body -&gt; å–å¾—ç™¼å‡º POST Request æ™‚å¤¾å¸¶åœ¨ body æ¬„ä½çš„å…§å®¹ã€‚<ul>
<li>å–å¾—çš„è³‡æ–™ç‚ºç´” bytes éœ€è¦è½‰è­¯ã€‚</li>
</ul>
</li>
<li>Request.json -&gt; ç•¶ content_type ç‚º &quot;application/json&quot; æ™‚ï¼Œæœƒè‡ªå‹•å°‡ body ä¸­çš„å…§å®¹è½‰ç‚º Python Dictionary</li>
</ul>
<pre><code class="language-python">import asyncio
import asyncio
import time
from sanic import Sanic, HTTPResponse, Request, response

app = Sanic(__name__)

@app.get(&quot;/typed&quot;)
def typed(request: Request) -&gt; HTTPResponse:
    &quot;&quot;&quot;
    get Done(sync)
    
    :param reuqest [sanic.Request]
    &quot;&quot;&quot;
    time.sleep(1)
    return response.text(&quot;Done&quot;)


@app.get(&quot;/async_typed/&lt;tag&gt;&quot;)
async def async_typed(request: Request, tag: str) -&gt; HTTPResponse:
    &quot;&quot;&quot;
    get Done(async)
    
    :param reuqest [sanic.Request]
    &quot;&quot;&quot;
    await asyncio.sleep(1)
    return response.text(&quot;Done&quot;)
</code></pre>
<p>å°æ‡‰å®˜æ–¹æ–‡æª”ï¼š <a href="https://sanic.dev/en/guide/basics/handlers.html#a-word-about-async" target="_blank" rel="noreferrer noopenner">https://sanic.dev/en/guide/basics/handlers.html#a-word-about-async</a></p>
<blockquote>
<p>å¯¦å‹™ä¸Šæ‡‰è©²ç›¡é‡ä½¿ç”¨ async / await ä»¥é¿å…åŸ·è¡Œç·’é˜»å¡ï¼ŒåŸ·è¡Œä¸Šæœƒæ›´æœ‰æ•ˆç‡ã€‚</p>
</blockquote>
<h2 id="routing" class="heading-item">Routing</h2><p>Routing ç”¨æ–¼å°‡ Handler è¨»å†Šè‡³å°æ‡‰çš„ URLï¼Œç•¶ä¼ºæœå™¨æ¥æ”¶åˆ°å°æ‡‰è·¯ç”±æ™‚ï¼Œæœƒå°‡æ”¶åˆ°çš„è³‡æ–™è½‰æ›æˆ Request ä¸¦åŸ·è¡Œå°æ‡‰çš„ Handlerã€‚</p>
<p>è¨»å†Š Routing çš„æ–¹å¼æœ‰ä¸‰ç¨®ï¼š</p>
<ul>
<li>é€é app.add_route() </li>
<li>é€é @app.route / @app.get ç­‰è£é£¾å™¨</li>
<li>Blueporint</li>
</ul>
<pre><code class="language-python">from sanic import Sanic, HTTPResponse, Request, response

app = Sanic(__name__)

def typed(request: Request) -&gt; HTTPResponse:
    &quot;&quot;&quot;
    get Done(sync)
    
    :param reuqest [sanic.Request]
    &quot;&quot;&quot;
    return response.text(&quot;Done&quot;)

# register route by decorator
@app.get(&quot;/async_typed/&lt;tag&gt;&quot;)
async def async_typed(request: Request, tag: str) -&gt; HTTPResponse:
    &quot;&quot;&quot;
    get Done(async)
    
    :param reuqest [sanic.Request]
    &quot;&quot;&quot;
    return response.text(&quot;Done&quot;)

# register route by add_route()
app.add_route(typed, &quot;/typed&quot;, methods=[&quot;GET&quot;])
</code></pre>
<p><code>@app.get()</code> ç­‰è£é£¾å™¨åªæ˜¯ <code>app.add_route()</code> çš„å°è£ï¼Œç”¨æ–¼å¢åŠ å¯è®€æ€§ã€‚</p>
<h3 id="blueprint" class="heading-item">Blueprint</h3><p>å„˜ç®¡èƒ½å¤ é€é <code>app.add_route()</code> è¨»å†Šè·¯ç”±ï¼Œä½†é€™æœƒå°è‡´æ‰€æœ‰ handler å¿…é ˆä¾è³´æ–¼ Sanic instanceï¼Œç•¶éœ€è¦è¨­ç½®çš„è·¯ç”±æ•¸é‡å¢åŠ æ™‚æœƒå¾ˆä¸æ–¹ä¾¿ï¼Œæ­¤æ™‚å¯æ¡ç”¨ blueprint æ–¹æ¡ˆã€‚</p>
<ul>
<li><strong>view.py</strong></li>
</ul>
<pre><code class="language-python">from sanic import Blueprint, HTTPResponse, Request, response

bp = Blueprint(&quot;peon&quot;)

def typed(request: Request) -&gt; HTTPResponse:
    &quot;&quot;&quot;
    get Done(sync)
    
    :param reuqest [sanic.Request]
    &quot;&quot;&quot;
    return response.text(&quot;Done&quot;)

# register route by decorator
@bp.get(&quot;/async_typed/&lt;tag&gt;&quot;)
async def async_typed(request: Request, tag: str) -&gt; HTTPResponse:
    &quot;&quot;&quot;
    get Done(async)
    
    :param reuqest [sanic.Request]
    &quot;&quot;&quot;
    return response.text(&quot;Done&quot;)

# Blueprint çš„ route è¨»å†Šæ–¹å¼èˆ‡ä½¿ç”¨ app.add_route ç›¸åŒã€‚
bp.add_route(typed, &quot;/typed&quot;, methods=[&quot;GET&quot;])
</code></pre>
<ul>
<li><strong>app.py</strong></li>
</ul>
<pre><code class="language-python">from sanic import Sanic, HTTPResponse, Request, response
from .view import bp

app = Sanic(__name__)

# ä½¿ç”¨ app.blueprint å°‡ blueprint instance è¨»å†Šé€² app è·¯ç”±ã€‚
app.blueprint(bp)
</code></pre>
<p>ä½¿ç”¨ Blueprint å¯ä»¥å°‡ Route èˆ‡ Handle èˆ‡ Sanic instance åˆ†é›¢é–‹ä¾†ï¼Œé”åˆ°é—œæ³¨é»åˆ†é›¢çš„æ•ˆæœã€‚</p>
<h2 id="app-registry" class="heading-item">App Registry</h2><p>ç•¶å»ºç«‹ Sanic instance æ™‚ï¼Œæœƒå°‡è©² instance å¯«å…¥ Sanic å…§éƒ¨çš„è¨»å†Šè¡¨ä¸­ï¼Œå¯ä»¥é€é <code>Sanic.get_app()</code> å–å¾— app çš„ instanceã€‚</p>
<ul>
<li><strong>app.py</strong></li>
</ul>
<pre><code class="language-python">from sanic import Sanic

app = Sanic(&quot;my_server&quot;)
</code></pre>
<ul>
<li><strong>db.py</strong></li>
</ul>
<pre><code class="language-python">from sanic import Sanic

app = Sanic.get_app(&quot;my_server&quot;)
</code></pre>
<p>è‹¥å»ºç«‹çš„ instance åªæœ‰ä¸€å€‹æ™‚ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨å¡«å…¥ instance nameï¼Œç›´æ¥ä½¿ç”¨ <code>Sanic.get_app()</code> å°±èƒ½å–å¾— instance ã€‚</p>
<h2 id="app-context" class="heading-item">App Context</h2><p>App Context ï¼ˆä¸­æ–‡ç¿»è­¯ç¨±ä½œä¸Šä¸‹æ–‡ï¼‰ç”¨æ–¼é™„åŠ å¸Œæœ›<strong>èƒ½å¤ é‡è¤‡ä½¿ç”¨çš„ instance</strong> ï¼Œåƒæ˜¯èˆ‡è³‡æ–™åº«çš„é€£æ¥ ã€å®šæœŸé‹ä½œçš„æ’ç¨‹å™¨ç­‰ã€‚</p>
<ul>
<li><strong>app.py</strong></li>
</ul>
<pre><code class="language-python">from sanic import Sanic, HTTPResponse, Request, response
from .view import bp
from . import scheduler

app = Sanic(__name__)

# lifecycle hook - åœ¨ server é‹è¡Œä¹‹å‰å°‡ instance è¨»å†Šé€² context.
@app.before_server_start
async def startup(app: Sanic):
    scheduler.setup(app)

app.blueprint(bp)
</code></pre>
<ul>
<li><strong>scheduler.py</strong></li>
</ul>
<pre><code class="language-python">from sanic import Sanic

from .struct import AppScheduler

SERVICE_CODE = &quot;app_scheduler&quot;

def get() -&gt; AppScheduler:
    app = Sanic.get_app()
    # ä½¿ç”¨ getattr å–å¾— app.ctx ä¸­çš„ instance
    return getattr(app.ctx, SERVICE_CODE)

def setup(app: Sanic) -&gt; AppScheduler:
    app = Sanic.get_app()
    scheduler = AppScheduler(app)
    # ä½¿ç”¨ setattr å°‡ instance å¯«å…¥ app.ctx
    setattr(app.ctx, SERVICE_CODE, scheduler)
    return scheduler
</code></pre>
<ul>
<li><strong>view.py</strong></li>
</ul>
<pre><code class="language-python">from sanic import Blueprint, HTTPResponse, Request, response
from . import scheduler

bp = Blueprint(&quot;peon&quot;)
def typed(request: Request) -&gt; HTTPResponse:
    &quot;&quot;&quot;
    get Done(sync)
    
    :param reuqest [sanic.Request]
    &quot;&quot;&quot;
    _scheudler = scheduler.get()
    return response.text(&quot;Done&quot;)
</code></pre>
<p>ç¯„ä¾‹ä¸­ä½¿ç”¨ <code>@app.before_server_start</code> åœ¨é‹è¡Œä¹‹å‰å°‡ AppScheduler åµŒå…¥ app.ctx å…§ã€‚ ä¸¦åœ¨ handler ä¸­é <code>scheduler.get()</code> å°‡å…¶å¾ app.ctx ä¸­å–å‡ºï¼Œè—‰æ­¤é‡è¤‡åˆ©ç”¨ instanceã€‚</p>
<h2 id="listener-lifecycle" class="heading-item">Listener (LifeCycle)</h2><p>Sanic åŒ…å« 8 å€‹ Hookï¼š</p>
<p><strong>åªåœ¨ sanic app å»ºç«‹/åœæ­¢æ™‚åŸ·è¡Œä¸€æ¬¡:</strong></p>
<ul>
<li>main_process_start</li>
<li>main_process_stop</li>
</ul>
<p><strong>æ¯å€‹ worker éƒ½æœƒåŸ·è¡Œä¸€æ¬¡</strong></p>
<ul>
<li>before_server_start</li>
<li>after_server_start</li>
<li>before_server_stop</li>
<li>after_server_stop</li>
</ul>
<p><strong>ç•¶ auto_reload è¢«é–‹å•Ÿæ™‚ï¼Œæ¯æ¬¡ reload å°±æœƒåŸ·è¡Œä¸€æ¬¡</strong></p>
<ul>
<li>reload_process_start</li>
<li>reload_process_stop</li>
</ul>
<pre><code class="language-python">@app.reload_process_start
async def reload_start(*_):
    print(&quot;&gt;&gt;&gt;&gt;&gt;&gt; reload_start &lt;&lt;&lt;&lt;&lt;&lt;&quot;)


@app.main_process_start
async def main_start(*_):
    print(&quot;&gt;&gt;&gt;&gt;&gt;&gt; main_start &lt;&lt;&lt;&lt;&lt;&lt;&quot;)
</code></pre>
<ul>
<li><code>main_process_start</code> ç¶“å¸¸ç”¨æ–¼åˆå§‹åŒ–åƒ…èƒ½åˆå§‹åŒ–ä¸€æ¬¡çš„æ™‚å€™ï¼ˆè¨­ç½®é ç«¯çš„ webhook)</li>
<li><code>before_server_start</code> åŠ <code>after_server_start</code> å¸¸ç”¨æ–¼å»ºç«‹å¯é‡è¤‡ä½¿ç”¨çš„ instance ä¸¦ä¸”é™„åŠ è‡³ app.ctx ä½œç‚ºå¸¸é§ service ä½¿ç”¨ã€‚</li>
<li><code>before_server_stop</code> ç”¨æ–¼é—œé–‰å„ service çš„é€£æ¥ä¸¦æ¸…é™¤è³‡æ–™ã€‚</li>
</ul>
<h2 id="æ‡‰ç”¨ç¯„ä¾‹" class="heading-item">æ‡‰ç”¨ç¯„ä¾‹</h2><blockquote>
<p><strong>Sanic Example</strong><br/>
Github: <a href="https://github.com/saweima12/sanic-example" target="_blank" rel="noreferrer noopenner">é»æˆ‘é€²å…¥</a></p>
</blockquote>
<h2 id="tldr" class="heading-item">TL;DR</h2><ul>
<li>Sanic æ˜¯ Python 3.8 ç‰ˆæœ¬ä»¥ä¸Šçš„è¼•é‡ Web æ¡†æ¶ï¼Œæ”¯æ´ async / await çš„éåŒæ­¥ç‰¹æ€§ã€‚</li>
<li>æ¨è–¦ä½¿ç”¨ Sanic CLI é‹è¡Œ Server ï¼Œåœ¨ç’°å¢ƒé…ç½®ä¸Šæœ‰æ›´å¤šçš„å½ˆæ€§ã€‚</li>
<li>Handler æ˜¯è™•ç† Request çš„åŸºæœ¬å–®å…ƒï¼Œæœƒ<strong>è‡³å°‘æ¥æ”¶ä¸€å€‹ Request ç‰©ä»¶ä¸¦è¿”å› HttpResponse ç‰©ä»¶</strong>ã€‚</li>
<li>æ‡‰è©²<strong>ç›¡é‡ä½¿ç”¨ async / await</strong> è™•ç† handler é‚è¼¯ï¼Œé¿å…åŸ·è¡Œç·’é˜»å¡ã€å¢åŠ é‹ä½œæ•ˆç‡ã€‚</li>
<li>Routing ç”¨æ–¼<strong>å°‡è·¯ç”±èˆ‡ Handler é€²è¡Œç¶å®š</strong>ï¼Œç•¶ Server æ¥æ”¶åˆ°æŒ‡å®šçš„è·¯å¾‘æ™‚ï¼Œæœƒå°‡è³‡æ–™æ‰“åŒ…æˆ Request é€è‡³å°æ‡‰çš„ Handlerã€‚</li>
<li>App Context ç”¨æ–¼<strong>å­˜æ”¾å¸Œæœ›é‡è¤‡ä½¿ç”¨çš„ instance</strong>ï¼Œåƒæ˜¯è³‡æ–™åº«é€£æ¥ã€æ’ç¨‹å™¨ç­‰ã€‚</li>
</ul>
<!-- HTML_TAG_END --></article></div></div>

</div></main>
				<footer class="w-full pt-20 pb-5 site-footer svelte-1esoz7b"><div class="flex justify-center items-center px-10 h-full footer-container"><div class="copyright">Copyright Â© 2020 - 2022 Saweicore Lab All Rights Reserved.</div></div>
</footer></div>

			<div class="hidden lg:block drawer-wrapper mr-0.5"><div class="w-full min-h-screen h-full drawer-container"><div class="flex flex-col h-full widget-list"><div class="widget-list-item my-3 svelte-zx3hu4"><div class="w-full cursor-pointer search-widget svelte-q0vdx1"><div class="flex flex-row h-full justify-center items-center label svelte-q0vdx1"><div class="flex self-center mr-2 w-4 label-icon"><svg viewBox="0 0 24 24" aria-hidden="true" class="svelte-1h287kj"><path fill="currentColor" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"></path></svg></div>
        <div class="label-text mr-2">Search</div>
        <div class="flex label-container items-center label-keys"><div class="label-key svelte-q0vdx1">Ctrl</div>
            <div class="label-key svelte-q0vdx1">/</div></div></div>
</div></div>

    <div class="widget-list-item svelte-zx3hu4"><div class="author-widget"><div class="w-32 h-32"><img class="avatar svelte-9pb7ln" src="https://avatars.githubusercontent.com/u/62002212" alt="Saweima" loading="lazy" width="128" height="128"></div>  
    <div class="mt-3 name svelte-9pb7ln"><h2>Saweima</h2></div> 
    <div class="mr-3 letter-content-font description svelte-9pb7ln"><p>é›œé …å·¥ç¨‹å¸« | å¹£åœˆå°ç™½ | æƒ³åˆ°å†å¯«</p></div>
</div></div>
    
    <div class="widget-list-item sticky top-14 svelte-zx3hu4">

<div class="outline-widget svelte-1tqky31"><ul class="overflow-y-auto outline-list svelte-1tqky31"><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#æ¡†æ¶ç‰¹æ€§" class="svelte-1tqky31">æ¡†æ¶ç‰¹æ€§</a>
            </div><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#å»ºç«‹åŸºæœ¬çµæ§‹" class="svelte-1tqky31">å»ºç«‹åŸºæœ¬çµæ§‹</a>
            </div><div class="level-3 py-0.5 outline-item svelte-1tqky31"><a href="#é€é-apprun-é‹è¡Œ" class="svelte-1tqky31">é€é app.run() é‹è¡Œ</a>
            </div><div class="level-3 py-0.5 outline-item svelte-1tqky31"><a href="#é€é-cli-é‹è¡Œæ¨è–¦" class="svelte-1tqky31">é€é CLI é‹è¡Œ(æ¨è–¦)</a>
            </div><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#handler" class="svelte-1tqky31">Handler</a>
            </div><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#routing" class="svelte-1tqky31">Routing</a>
            </div><div class="level-3 py-0.5 outline-item svelte-1tqky31"><a href="#blueprint" class="svelte-1tqky31">Blueprint</a>
            </div><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#app-registry" class="svelte-1tqky31">App Registry</a>
            </div><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#app-context" class="svelte-1tqky31">App Context</a>
            </div><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#listener-lifecycle" class="svelte-1tqky31">Listener (LifeCycle)</a>
            </div><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#æ‡‰ç”¨ç¯„ä¾‹" class="svelte-1tqky31">æ‡‰ç”¨ç¯„ä¾‹</a>
            </div><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#tldr" class="svelte-1tqky31">TL;DR</a>
            </div></ul>
</div></div>


</div></div></div></div></div></div>

<div class="fixed top-0 z-10 w-screen h-screen screenmask hidden"></div>


<div class="fixed z-30 top-0 left-0 bottom-0 w-60 md:w-80 h-screen transition-all duration-200 navmenu svelte-7saduy -translate-x-full"><div class="flex flex-col h-full navmenu-container"><div class="py-4 mb-2 header"><div class="flex items-center mb-4 pl-8"><div class="title text-lg svelte-7saduy">Saweicore Lab</div>
					<button class="flex text-xl letter-content-font theme-switch svelte-7saduy"><div class="icon-base w-6"><svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>ic_fluent_dark_theme_24_filled</title><desc>Created with Sketch.</desc><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill="#212121" fill-rule="nonzero"><path fill="currentColor" d="M12,22 C17.5228475,22 22,17.5228475 22,12 C22,6.4771525 17.5228475,2 12,2 C6.4771525,2 2,6.4771525 2,12 C2,17.5228475 6.4771525,22 12,22 Z M12,20 L12,4 C16.418278,4 20,7.581722 20,12 C20,16.418278 16.418278,20 12,20 Z" id="ğŸ¨-Color"></path></g></g></svg></div></button></div>

			<div class="flex flex-row mx-6 author-block svelte-7saduy"><img src="https://avatars.githubusercontent.com/u/62002212" alt="saweima" loading="lazy" width="80" height="80" class="svelte-7saduy">
				<div class="flex flex-col word-font items-center justify-center ml-4 avatar-info"><div class="font-bold text-lg">Saweima</div>
					<div>é‚Šç·£å·¥ä½œè€…</div></div></div></div>
		<ul class="nav-list">
			<li class="flex nav-item svelte-7saduy"><a sveltekit:prefetch href="/journal" alt="" class="w-full h-full"><div class="flex items-center pl-8 mt-1 mb-4 nav-item-content"><div class="icon-base w-6"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" fill-rule="evenodd" d="M19,2 C20.6568542,2 22,3.34314575 22,5 L22,19 C22,20.6568542 20.6568542,22 19,22 L5,22 C3.34314575,22 2,20.6568542 2,19 L2,5 C2,3.34314575 3.34314575,2 5,2 L19,2 Z M20,8 L4,8 L4,19 C4,19.5522847 4.44771525,20 5,20 L19,20 C19.5522847,20 20,19.5522847 20,19 L20,8 Z M12.1167504,17.9932723 L12.0000776,18 L11.916,17.996 L11.7993725,17.9797599 L11.7993725,17.9797599 L11.6879528,17.9502619 L11.6879528,17.9502619 L11.5768709,17.9063266 L11.5768709,17.9063266 L11.4793812,17.8540045 L11.4793812,17.8540045 L11.4049183,17.8036865 L11.4049183,17.8036865 L11.2929784,17.7071068 L8.29290079,14.7071068 C7.9023664,14.3165825 7.9023664,13.6834175 8.29290079,13.2928932 C8.65339407,12.9324093 9.22063979,12.9046797 9.61294114,13.2097046 L9.70715092,13.2928932 L11,14.585 L11.0000776,11 C11.0000776,10.4871642 11.3861178,10.0644928 11.8834564,10.0067277 L12.0001293,10 C12.552414,10 13.0001293,10.4477153 13.0001293,11 L13,14.585 L14.2930559,13.2928932 C14.6535492,12.9324093 15.2207949,12.9046797 15.6130963,13.2097046 L15.707306,13.2928932 C16.0677993,13.6533772 16.0955296,14.2206082 15.7904968,14.6128994 L15.707306,14.7071068 L12.7072361,17.7071068 L12.6217218,17.7833908 L12.6217218,17.7833908 L12.5518984,17.8341416 L12.5518984,17.8341416 L12.4539624,17.8913373 L12.4539624,17.8913373 L12.3401306,17.9407132 L12.3401306,17.9407132 L12.2661033,17.9641549 L12.1167504,17.9932723 L12.1167504,17.9932723 Z M19,4 L5,4 C4.44771525,4 4,4.44771525 4,5 L4,6 L20,6 L20,5 C20,4.44771525 19.5522847,4 19,4 Z"></path></svg></div>
					<div class="pl-4 text-xl letter-content-font">Journal</div>
					</div>
				</a>
			</li>
			<li class="flex nav-item svelte-7saduy"><a sveltekit:prefetch href="/about" alt="" class="w-full h-full"><div class="flex items-center pl-8 mt-1 mb-4 nav-item-content"><div class="icon-base w-6"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" xmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 512 512"><g><g><path fill="currentColor" d="m480.6,11c-40.6,0-80.2,12.7-118.6,25-36.9,11.9-71.8,23.1-106,23.1-34.2,0-69.1-11.2-106-23.1-38.3-12.3-78-25-118.6-25-11.3,0-20.4,9.1-20.4,20.4v401c0,11.3 9.1,20.4 20.4,20.4 34.2,0 69.1,11.2 106,23.1 38.3,12.3 77.9,25 118.5,25 40.6,0 80.2-12.7 118.5-25 36.9-11.9 71.8-23.1 106-23.1 11.3,0 20.4-9.1 20.4-20.4v-401c0.2-11.3-8.9-20.4-20.2-20.4zm-428.8,402.1v-360c27.7,3.2 56,12.3 85.6,21.9 31.9,10.2 64.6,20.8 98.1,24v360c-27.7-3.2-56-12.3-85.6-21.8-31.8-10.4-64.6-20.9-98.1-24.1zm408.4,0c-33.5,3.3-66.3,13.8-98.1,24-29.6,9.5-57.9,18.6-85.6,21.8v-360c33.5-3.3 66.3-13.8 98.1-24 29.6-9.5 57.9-18.6 85.6-21.9v360.1z"></path><path fill="currentColor" d="m183.6,144l-68.1-20.4c-10.8-3.2-22.2,2.9-25.4,13.7-3.2,10.8 2.9,22.2 13.7,25.4 0,0 72,21.3 73.9,21.3 8.8,0 16.9-5.7 19.5-14.6 3.3-10.7-2.8-22.1-13.6-25.4z"></path><path fill="currentColor" d="m183.6,246.6l-68.1-20.4c-10.8-3.2-22.2,2.9-25.4,13.7-3.2,10.8 2.9,22.2 13.7,25.4 0,0 72,21.3 73.9,21.3 8.8,0 16.9-5.7 19.5-14.6 3.3-10.7-2.8-22.1-13.6-25.4z"></path><path fill="currentColor" d="m183.6,349.3l-68.1-20.4c-10.8-3.2-22.2,2.9-25.4,13.7-3.2,10.8 2.9,22.2 13.7,25.4 0,0 72,21.3 73.9,21.3 8.8,0 16.9-5.7 19.5-14.6 3.3-10.8-2.8-22.2-13.6-25.4z"></path><path fill="currentColor" d="m314.7,169.4c2.7,8.9 10.8,14.6 19.5,14.6 1.9,0 73.9-21.3 73.9-21.3 10.8-3.2 16.9-14.6 13.7-25.4-3.3-10.8-14.6-16.9-25.4-13.7l-68,20.4c-10.8,3.3-16.9,14.7-13.7,25.4z"></path><path fill="currentColor" d="m396.5,226.2l-68.1,20.4c-10.8,3.2-16.9,14.6-13.7,25.4 2.7,8.9 10.8,14.6 19.5,14.6 1.9,0 73.9-21.3 73.9-21.3 10.8-3.2 16.9-14.6 13.7-25.4-3.2-10.8-14.5-16.8-25.3-13.7z"></path><path fill="currentColor" d="m396.5,328.9l-68.1,20.4c-10.8,3.2-16.9,14.6-13.7,25.4 2.7,8.9 10.8,14.6 19.5,14.6 1.9,0 73.9-21.3 73.9-21.3 10.8-3.2 16.9-14.6 13.7-25.4-3.2-10.8-14.5-16.9-25.3-13.7z"></path></g></g></svg></div>
					<div class="pl-4 text-xl letter-content-font">About</div>
					</div>
				</a>
			</li>
			<li class="flex nav-item svelte-7saduy"><a href="http://github.com/saweima12" alt="" class="w-full h-full"><div class="flex items-center pl-8 mt-1 mb-4 nav-item-content"><div class="icon-base w-6"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" class="icon"><path fill="currentColor" d="m256 0c-140.609375 0-256 115.390625-256 256 0 119.988281 84.195312 228.984375 196 256v-84.695312c-11.078125 2.425781-21.273438 2.496093-32.550781-.828126-15.128907-4.464843-27.421875-14.542968-36.546875-29.910156-5.816406-9.8125-16.125-20.453125-26.878906-19.671875l-2.636719-29.882812c23.253906-1.992188 43.371093 14.167969 55.3125 34.230469 5.304687 8.921874 11.410156 14.152343 19.246093 16.464843 7.574219 2.230469 15.707032 1.160157 25.183594-2.1875 2.378906-18.972656 11.070313-26.074219 17.636719-36.074219v-.015624c-66.679687-9.945313-93.253906-45.320313-103.800781-73.242188-13.976563-37.074219-6.476563-83.390625 18.238281-112.660156.480469-.570313 1.347656-2.0625 1.011719-3.105469-11.332032-34.230469 2.476562-62.546875 2.984375-65.550781 13.078125 3.867187 15.203125-3.890625 56.808593 21.386718l7.191407 4.320313c3.007812 1.792969 2.0625.769531 5.070312.542969 17.371094-4.71875 35.683594-7.324219 53.726563-7.558594 18.179687.234375 36.375 2.839844 54.464844 7.75l2.328124.234375c-.203124-.03125.632813-.148437 2.035157-.984375 51.972656-31.480469 50.105469-21.191406 64.042969-25.722656.503906 3.007812 14.128906 31.785156 2.917968 65.582031-1.511718 4.65625 45.058594 47.300781 19.246094 115.753906-10.546875 27.933594-37.117188 63.308594-103.796875 73.253907v.015624c8.546875 13.027344 18.816406 19.957032 18.761719 46.832032v105.722656c111.808594-27.015625 196-136.011719 196-256 .003906-140.609375-115.386719-256-255.996094-256zm0 0"></path></svg></div>
					<div class="pl-4 text-xl letter-content-font">Github</div>
					<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div>
				</a>
			</li></ul>
		<div class="grow spacer"></div></div>
</div>


<div class="search-box svelte-fha6x8 hidden"><div class="search-bar svelte-fha6x8"><form class="flex items-center p-5 h-full" autocomplete="off" role="search"><div class="icon-base w-8 mr-4"><svg viewBox="0 0 24 24" aria-hidden="true" class="svelte-1h287kj"><path fill="currentColor" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"></path></svg></div>
            <input id="search-input" type="text" autocomplete="off" class="h-full w-full svelte-fha6x8"></form></div>
    <div class="typehead-wrapper"><div class="typehead-container">
</div></div>
</div>
<div class="lightbox-wrapper svelte-1b9dfdw translate-x-full opacity-0"><div class="flex items-center h-full lightbox-container svelte-1b9dfdw"></div>
</div>




		<script type="module" data-sveltekit-hydrate="fr5yus">
		import { set_public_env, start } from "../../../_app/immutable/start-34fd70cd.js";

		set_public_env({});

		start({
			target: document.querySelector('[data-sveltekit-hydrate="fr5yus"]').parentNode,
			paths: {"base":"","assets":""},
			route: true,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				node_ids: [0, 7],
				params: {year:"2022",month:"08",slug:"sanic-introduce"},
				routeId: "posts/[year]/[month]/[slug]"
			}
		});
	</script>
	<script type="application/json" sveltekit:data-type="data" sveltekit:data-url="/api/config.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"{\"title\":\"Saweicore Lab\",\"summary\":\"ç¨‹å¼é–‹ç™¼ | ç¶²ç«™æ¶è¨­ | å¹£åœˆé›œè«‡ | å„é …é›œç‡´é›†æ•£åœ°\",\"description\":\"SaweiCore Lab æ˜¯ç”¨æ–¼è¨˜éŒ„èˆ‡æ­¸æª”å€‹äººçš„ç ”ç©¶å¿ƒå¾—çš„é›†æ•£åœ°ï¼Œå…§å®¹å¤šä»¥ç¶²ç«™æ¶è¨­ã€ç¨‹å¼é–‹ç™¼ã€å¹£åœˆæ¢ç´¢ç‚ºä¸»ä¸¦ä»¥éœ€æ±‚å°å‘æ¢è¨å•é¡Œä¸¦è¨˜éŒ„å°æ‡‰çš„è§£æ±ºæ–¹æ¡ˆï¼Œä»¥ä¾¿å¾ŒçºŒæŸ¥é–±ã€‚\",\"url\":\"https://saweicore.com\",\"ga\":\"G-KY269QECHX\",\"author\":{\"name\":\"Saweima\",\"email\":\"saweima12@gmail.com\",\"summary\":\"é‚Šç·£å·¥ä½œè€…\",\"description\":\"é›œé …å·¥ç¨‹å¸« | å¹£åœˆå°ç™½ | æƒ³åˆ°å†å¯«\",\"avatar\":\"https://avatars.githubusercontent.com/u/62002212\"},\"pagination\":{\"maxPerPage\":8},\"classifier\":[{\"id\":\"post\",\"params\":{\"path\":\"/_posts/\"},\"type\":\"directory\"},{\"id\":\"tag\",\"params\":{\"keys\":[\"tag\",\"tags\"]},\"type\":\"frontmatter\"}],\"marked\":{\"options\":{},\"extensions\":[{\"renderer\":{}},{\"renderer\":{}}]},\"search\":{\"appKey\":\"BHODY4NQKK\",\"apiKey\":\"5f4c05344cf6d1cbe581c20e049a7c14\",\"index\":\"SaweicoreLab\"},\"nav\":[{\"id\":\"journal\",\"name\":\"Journal\",\"link\":\"/journal\"},{\"id\":\"about\",\"name\":\"About\",\"link\":\"/about\"},{\"id\":\"github\",\"name\":\"Github\",\"link\":\"http://github.com/saweima12\"}]}"}</script>
	<script type="application/json" sveltekit:data-type="data" sveltekit:data-url="/api/posts/2022/08/sanic-introduce.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"{\"metadata\":{\"title\":\"Sanic - è¼•é‡å¿«é€Ÿçš„ Python Web Framework\",\"tags\":[\"web\",\"python\",\"programing\"],\"excerpt\":\"ä¸€æ¬¾æ”¯æ´éåŒæ­¥èª¿ç”¨ä¸é˜»å¡åŸ·è¡Œç·’ã€ç·¨å¯«é¢¨æ ¼ç°¡æ½”ä¸æ‹–æ³¥å¸¶æ°´ã€å…§ç½®é«˜æ•ˆç‡ä¼ºæœå™¨æ–¹ä¾¿éƒ¨ç½²çš„ Python æ¡†æ¶ï¼Œé©åˆç”¨æ–¼å¿«é€Ÿé–‹ç™¼ä¸­å°å‹å°ˆæ¡ˆã€‚\",\"created\":\"2022-08-08T00:00:00.000Z\"},\"content\":\"\u003Cp>Sanic æ˜¯ä¸€æ¬¾ Python çš„ Web æ¡†æ¶ï¼Œç·¨å¯«é¢¨æ ¼ç¹¼æ‰¿äº†è€ç‰Œæ¡†æ¶ Flask çš„ç°¡æ½”ä¸¦åœ¨å…¶ä¹‹ä¸Šæ·»åŠ  async / await çš„éåŒæ­¥èª¿ç”¨æ”¯æ´ï¼Œå¤–åŠ å…§å»ºå¿«é€Ÿé«˜æ•ˆçš„ HTTP Serverï¼Œæä¾›äº†é–‹ç®±å³ç”¨ã€å¿«é€Ÿé–‹ç™¼ã€ç”Ÿç”¢éƒ¨ç½²çš„è§£æ±ºæ–¹æ¡ˆã€‚\u003C/p>\\n\u003Cblockquote>\\n\u003Cp>\u003Cstrong>Sanic\u003C/strong>\u003Cbr/>\\nå®˜æ–¹ç¶²ç«™ï¼š \u003Ca href=\\\"https://sanic.dev/\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopenner\\\">é»æˆ‘é€²å…¥\u003C/a>\u003Cbr/>\u003C/p>\\n\u003C/blockquote>\\n\u003Cp>\u003Cstrong>å®‰è£æ–¹å¼ï¼š\u003C/strong>\u003C/p>\\n\u003Cpre>\u003Ccode class=\\\"language-sh\\\">pip install sanic\\n\u003C/code>\u003C/pre>\\n\u003Ch2 id=\\\"æ¡†æ¶ç‰¹æ€§\\\" class=\\\"heading-item\\\">æ¡†æ¶ç‰¹æ€§\u003C/h2>\u003Cul>\\n\u003Cli>ä½¿ç”¨ Python 3.8 ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼ˆæ¨è–¦ç›´æ¥ä½¿ç”¨ Python 3.10ï¼‰\u003C/li>\\n\u003Cli>æ”¯æ´ async / await éåŒæ­¥ç‰¹æ€§ï¼ˆåŸ·è¡Œ IO æ“ä½œæ™‚ä¸æœƒé˜»å¡ï¼‰\u003C/li>\\n\u003Cli>å…§å»ºå¿«é€Ÿçš„ HTTP Server \u003C/li>\\n\u003Cli>é¡ Flask çš„ç°¡æ½”æ¶æ§‹ï¼Œæ˜“æ–¼æ“´å……èˆ‡ç·¨å¯«ã€‚\u003C/li>\\n\u003C/ul>\\n\u003Cblockquote>\\n\u003Cp>ç·¨å¯«é€™é‚Šæ–‡ç« æ™‚ä½¿ç”¨çš„ç‰ˆæœ¬ç‚º \u003Cstrong>22.6.1\u003C/strong>ï¼Œé€šå¸¸ä½¿ç”¨æœ€æ–°çš„ç‰ˆæœ¬å³å¯ã€‚\u003C/p>\\n\u003C/blockquote>\\n\u003Ch2 id=\\\"å»ºç«‹åŸºæœ¬çµæ§‹\\\" class=\\\"heading-item\\\">å»ºç«‹åŸºæœ¬çµæ§‹\u003C/h2>\u003Cp>å•Ÿå‹• Sanic  çš„æ–¹å¼æœ‰ä»¥ä¸‹å…©ç¨®ï¼š\u003C/p>\\n\u003Cul>\\n\u003Cli>é€éè…³æœ¬é‹è¡Œ -&gt; åœ¨ç·¨å¯«è…³æœ¬ä¸­ä½¿ç”¨ \u003Ccode>Sanic.run()\u003C/code> é‹è¡Œã€‚\u003C/li>\\n\u003Cli>ä½¿ç”¨ CLI -&gt; ä½¿ç”¨ \u003Ccode>Sanic CLI\u003C/code> å°‡ application ä½œç‚º module å°å…¥(\u003Cstrong>æ¨è–¦\u003C/strong>)\u003C/li>\\n\u003C/ul>\\n\u003Ch3 id=\\\"é€é-apprun-é‹è¡Œ\\\" class=\\\"heading-item\\\">é€é app.run() é‹è¡Œ\u003C/h3>\u003Cp>åœ¨æ ¹ç›®éŒ„ä¸­å»ºç«‹ app.py ï¼Œä¸¦å»ºç«‹ Sanic instanceï¼Œé€é app.run é‹è¡Œä¼ºæœå™¨ã€‚\u003C/p>\\n\u003Cpre>\u003Ccode class=\\\"language-python\\\">from sanic import Sanic\\n\\n# create sanic app\\napp = Sanic(__name__)\\n\\nif __name__ == &#39;__main__&#39;:\\n        # é€é app.run é‹è¡Œ\\n    app.run(host=&quot;0.0.0.0&quot;, debug=True)\\n\u003C/code>\u003C/pre>\\n\u003Ch3 id=\\\"é€é-cli-é‹è¡Œæ¨è–¦\\\" class=\\\"heading-item\\\">é€é CLI é‹è¡Œ(æ¨è–¦)\u003C/h3>\u003Cp> å»ºç«‹ä»¥ä¸‹è³‡æ–™å¤¾çµæ§‹ï¼Œç•¶è³‡æ–™å¤¾å…§æœ‰ \u003Ccode>__init__.py\u003C/code> æª”æ¡ˆæ™‚ï¼Œè©²è³‡æ–™å¤¾å°±æœƒè¢« python è¦–ç‚º pacakgeã€‚\u003C/p>\\n\u003Cpre>\u003Ccode class=\\\"language-text\\\">/\\nâ”œâ”€ sanicapp\\nâ”‚   â””â”€  __init__.py\\nâ””â”€ run.sh\\n\u003C/code>\u003C/pre>\\n\u003Cul>\\n\u003Cli>\u003Ccode>__init__.py\u003C/code>  ä¸­å»ºç«‹ Sanic Instance ã€‚\u003C/li>\\n\u003C/ul>\\n\u003Cpre>\u003Ccode class=\\\"language-python\\\">from sanic import Sanic\\n\\n# create sanic app\\napp = Sanic(__name__)\\n\\n# __name__ å¯æ”¹ç‚ºè‡ªå®šç¾© App åç¨±\\n\u003C/code>\u003C/pre>\\n\u003Cul>\\n\u003Cli>æœ€å¾Œä½¿ç”¨ä»¥ä¸‹ shell æŒ‡ä»¤åŸ·è¡Œ sanic ä¼ºæœå™¨ã€‚\u003C/li>\\n\u003C/ul>\\n\u003Cpre>\u003Ccode class=\\\"language-shell\\\">sanic sanicapp:app -H 0.0.0.0 -p 8080 -d\\n\u003C/code>\u003C/pre>\\n\u003Cul>\\n\u003Cli>\u003Ccode>sanicapp\u003C/code>ç‚º package çš„åç¨±ï¼Œ\u003Ccode>app\u003C/code> ç‚º instance è®Šé‡ã€‚\u003C/li>\\n\u003Cli>\u003Ccode>-H\u003C/code> ç”¨æ–¼æŒ‡å®š Host Address (é è¨­ç‚º 127.0.0.1)\u003C/li>\\n\u003Cli>\u003Ccode>-p\u003C/code> ç”¨æ–¼æŒ‡å®š Port (é è¨­ç‚º 8000)\u003C/li>\\n\u003Cli>\u003Ccode>-d\u003C/code> ç”¨æ–¼é–‹å•Ÿ Debug æ¨¡å¼ï¼ˆæœƒè‡ªå‹•é‡è¼‰åŠçœ‹åˆ°æ›´è©³ç´°çš„ logï¼‰\u003C/li>\\n\u003Cli>\u003Ccode>-w\u003C/code> ç”¨æ–¼æŒ‡å®šè¦å•Ÿå‹•å¹¾å€‹ worker \u003C/li>\\n\u003Cli>å¯é€é \u003Ccode>-h\u003C/code> åƒæ•¸è§€çœ‹è©³ç´°çš„èªªæ˜\u003C/li>\\n\u003C/ul>\\n\u003Cp>ä½¿ç”¨ CLI é‹è¡Œ Sanic ä¼ºæœå™¨å¯ä»¥åœ¨é‹è¡Œç’°å¢ƒé…ç½®ä¸Šç²å¾—æ›´å¤šçš„å½ˆæ€§ã€‚ç•¶éœ€è¦æ”¹è®Š host æˆ–æ˜¯ debug mode æ™‚ï¼Œå¯ä»¥ç›´æ¥è®Šæ›´åƒæ•¸ï¼Œä¸éœ€è¦ä¿®æ”¹è…³æœ¬çš„ app.run çš„åƒæ•¸ã€‚\u003C/p>\\n\u003Ch2 id=\\\"handler\\\" class=\\\"heading-item\\\">Handler\u003C/h2>\u003Cp>Handler æ˜¯è™•ç† Request çš„åŸºæœ¬å–®å…ƒï¼Œ\u003Cstrong>è‡³å°‘æœƒæ”¶åˆ°ä¸€å€‹ Reqeust ç‰©ä»¶ä¸¦ return ä¸€å€‹ HTTPResponse\u003C/strong> ã€‚\u003C/p>\\n\u003Cul>\\n\u003Cli>Request.headers -&gt;  å–å¾—å¤¾å¸¶åœ¨ request header çš„è³‡æ–™ã€‚\u003C/li>\\n\u003Cli>Request.args  or Request.query_args -&gt; å–å¾— URLQueryParams\u003C/li>\\n\u003Cli>Request.body -&gt; å–å¾—ç™¼å‡º POST Request æ™‚å¤¾å¸¶åœ¨ body æ¬„ä½çš„å…§å®¹ã€‚\u003Cul>\\n\u003Cli>å–å¾—çš„è³‡æ–™ç‚ºç´” bytes éœ€è¦è½‰è­¯ã€‚\u003C/li>\\n\u003C/ul>\\n\u003C/li>\\n\u003Cli>Request.json -&gt; ç•¶ content_type ç‚º &quot;application/json&quot; æ™‚ï¼Œæœƒè‡ªå‹•å°‡ body ä¸­çš„å…§å®¹è½‰ç‚º Python Dictionary\u003C/li>\\n\u003C/ul>\\n\u003Cpre>\u003Ccode class=\\\"language-python\\\">import asyncio\\nimport asyncio\\nimport time\\nfrom sanic import Sanic, HTTPResponse, Request, response\\n\\napp = Sanic(__name__)\\n\\n@app.get(&quot;/typed&quot;)\\ndef typed(request: Request) -&gt; HTTPResponse:\\n    &quot;&quot;&quot;\\n    get Done(sync)\\n    \\n    :param reuqest [sanic.Request]\\n    &quot;&quot;&quot;\\n    time.sleep(1)\\n    return response.text(&quot;Done&quot;)\\n\\n\\n@app.get(&quot;/async_typed/&lt;tag&gt;&quot;)\\nasync def async_typed(request: Request, tag: str) -&gt; HTTPResponse:\\n    &quot;&quot;&quot;\\n    get Done(async)\\n    \\n    :param reuqest [sanic.Request]\\n    &quot;&quot;&quot;\\n    await asyncio.sleep(1)\\n    return response.text(&quot;Done&quot;)\\n\u003C/code>\u003C/pre>\\n\u003Cp>å°æ‡‰å®˜æ–¹æ–‡æª”ï¼š \u003Ca href=\\\"https://sanic.dev/en/guide/basics/handlers.html#a-word-about-async\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopenner\\\">https://sanic.dev/en/guide/basics/handlers.html#a-word-about-async\u003C/a>\u003C/p>\\n\u003Cblockquote>\\n\u003Cp>å¯¦å‹™ä¸Šæ‡‰è©²ç›¡é‡ä½¿ç”¨ async / await ä»¥é¿å…åŸ·è¡Œç·’é˜»å¡ï¼ŒåŸ·è¡Œä¸Šæœƒæ›´æœ‰æ•ˆç‡ã€‚\u003C/p>\\n\u003C/blockquote>\\n\u003Ch2 id=\\\"routing\\\" class=\\\"heading-item\\\">Routing\u003C/h2>\u003Cp>Routing ç”¨æ–¼å°‡ Handler è¨»å†Šè‡³å°æ‡‰çš„ URLï¼Œç•¶ä¼ºæœå™¨æ¥æ”¶åˆ°å°æ‡‰è·¯ç”±æ™‚ï¼Œæœƒå°‡æ”¶åˆ°çš„è³‡æ–™è½‰æ›æˆ Request ä¸¦åŸ·è¡Œå°æ‡‰çš„ Handlerã€‚\u003C/p>\\n\u003Cp>è¨»å†Š Routing çš„æ–¹å¼æœ‰ä¸‰ç¨®ï¼š\u003C/p>\\n\u003Cul>\\n\u003Cli>é€é app.add_route() \u003C/li>\\n\u003Cli>é€é @app.route / @app.get ç­‰è£é£¾å™¨\u003C/li>\\n\u003Cli>Blueporint\u003C/li>\\n\u003C/ul>\\n\u003Cpre>\u003Ccode class=\\\"language-python\\\">from sanic import Sanic, HTTPResponse, Request, response\\n\\napp = Sanic(__name__)\\n\\ndef typed(request: Request) -&gt; HTTPResponse:\\n    &quot;&quot;&quot;\\n    get Done(sync)\\n    \\n    :param reuqest [sanic.Request]\\n    &quot;&quot;&quot;\\n    return response.text(&quot;Done&quot;)\\n\\n# register route by decorator\\n@app.get(&quot;/async_typed/&lt;tag&gt;&quot;)\\nasync def async_typed(request: Request, tag: str) -&gt; HTTPResponse:\\n    &quot;&quot;&quot;\\n    get Done(async)\\n    \\n    :param reuqest [sanic.Request]\\n    &quot;&quot;&quot;\\n    return response.text(&quot;Done&quot;)\\n\\n# register route by add_route()\\napp.add_route(typed, &quot;/typed&quot;, methods=[&quot;GET&quot;])\\n\u003C/code>\u003C/pre>\\n\u003Cp>\u003Ccode>@app.get()\u003C/code> ç­‰è£é£¾å™¨åªæ˜¯ \u003Ccode>app.add_route()\u003C/code> çš„å°è£ï¼Œç”¨æ–¼å¢åŠ å¯è®€æ€§ã€‚\u003C/p>\\n\u003Ch3 id=\\\"blueprint\\\" class=\\\"heading-item\\\">Blueprint\u003C/h3>\u003Cp>å„˜ç®¡èƒ½å¤ é€é \u003Ccode>app.add_route()\u003C/code> è¨»å†Šè·¯ç”±ï¼Œä½†é€™æœƒå°è‡´æ‰€æœ‰ handler å¿…é ˆä¾è³´æ–¼ Sanic instanceï¼Œç•¶éœ€è¦è¨­ç½®çš„è·¯ç”±æ•¸é‡å¢åŠ æ™‚æœƒå¾ˆä¸æ–¹ä¾¿ï¼Œæ­¤æ™‚å¯æ¡ç”¨ blueprint æ–¹æ¡ˆã€‚\u003C/p>\\n\u003Cul>\\n\u003Cli>\u003Cstrong>view.py\u003C/strong>\u003C/li>\\n\u003C/ul>\\n\u003Cpre>\u003Ccode class=\\\"language-python\\\">from sanic import Blueprint, HTTPResponse, Request, response\\n\\nbp = Blueprint(&quot;peon&quot;)\\n\\ndef typed(request: Request) -&gt; HTTPResponse:\\n    &quot;&quot;&quot;\\n    get Done(sync)\\n    \\n    :param reuqest [sanic.Request]\\n    &quot;&quot;&quot;\\n    return response.text(&quot;Done&quot;)\\n\\n# register route by decorator\\n@bp.get(&quot;/async_typed/&lt;tag&gt;&quot;)\\nasync def async_typed(request: Request, tag: str) -&gt; HTTPResponse:\\n    &quot;&quot;&quot;\\n    get Done(async)\\n    \\n    :param reuqest [sanic.Request]\\n    &quot;&quot;&quot;\\n    return response.text(&quot;Done&quot;)\\n\\n# Blueprint çš„ route è¨»å†Šæ–¹å¼èˆ‡ä½¿ç”¨ app.add_route ç›¸åŒã€‚\\nbp.add_route(typed, &quot;/typed&quot;, methods=[&quot;GET&quot;])\\n\u003C/code>\u003C/pre>\\n\u003Cul>\\n\u003Cli>\u003Cstrong>app.py\u003C/strong>\u003C/li>\\n\u003C/ul>\\n\u003Cpre>\u003Ccode class=\\\"language-python\\\">from sanic import Sanic, HTTPResponse, Request, response\\nfrom .view import bp\\n\\napp = Sanic(__name__)\\n\\n# ä½¿ç”¨ app.blueprint å°‡ blueprint instance è¨»å†Šé€² app è·¯ç”±ã€‚\\napp.blueprint(bp)\\n\u003C/code>\u003C/pre>\\n\u003Cp>ä½¿ç”¨ Blueprint å¯ä»¥å°‡ Route èˆ‡ Handle èˆ‡ Sanic instance åˆ†é›¢é–‹ä¾†ï¼Œé”åˆ°é—œæ³¨é»åˆ†é›¢çš„æ•ˆæœã€‚\u003C/p>\\n\u003Ch2 id=\\\"app-registry\\\" class=\\\"heading-item\\\">App Registry\u003C/h2>\u003Cp>ç•¶å»ºç«‹ Sanic instance æ™‚ï¼Œæœƒå°‡è©² instance å¯«å…¥ Sanic å…§éƒ¨çš„è¨»å†Šè¡¨ä¸­ï¼Œå¯ä»¥é€é \u003Ccode>Sanic.get_app()\u003C/code> å–å¾— app çš„ instanceã€‚\u003C/p>\\n\u003Cul>\\n\u003Cli>\u003Cstrong>app.py\u003C/strong>\u003C/li>\\n\u003C/ul>\\n\u003Cpre>\u003Ccode class=\\\"language-python\\\">from sanic import Sanic\\n\\napp = Sanic(&quot;my_server&quot;)\\n\u003C/code>\u003C/pre>\\n\u003Cul>\\n\u003Cli>\u003Cstrong>db.py\u003C/strong>\u003C/li>\\n\u003C/ul>\\n\u003Cpre>\u003Ccode class=\\\"language-python\\\">from sanic import Sanic\\n\\napp = Sanic.get_app(&quot;my_server&quot;)\\n\u003C/code>\u003C/pre>\\n\u003Cp>è‹¥å»ºç«‹çš„ instance åªæœ‰ä¸€å€‹æ™‚ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨å¡«å…¥ instance nameï¼Œç›´æ¥ä½¿ç”¨ \u003Ccode>Sanic.get_app()\u003C/code> å°±èƒ½å–å¾— instance ã€‚\u003C/p>\\n\u003Ch2 id=\\\"app-context\\\" class=\\\"heading-item\\\">App Context\u003C/h2>\u003Cp>App Context ï¼ˆä¸­æ–‡ç¿»è­¯ç¨±ä½œä¸Šä¸‹æ–‡ï¼‰ç”¨æ–¼é™„åŠ å¸Œæœ›\u003Cstrong>èƒ½å¤ é‡è¤‡ä½¿ç”¨çš„ instance\u003C/strong> ï¼Œåƒæ˜¯èˆ‡è³‡æ–™åº«çš„é€£æ¥ ã€å®šæœŸé‹ä½œçš„æ’ç¨‹å™¨ç­‰ã€‚\u003C/p>\\n\u003Cul>\\n\u003Cli>\u003Cstrong>app.py\u003C/strong>\u003C/li>\\n\u003C/ul>\\n\u003Cpre>\u003Ccode class=\\\"language-python\\\">from sanic import Sanic, HTTPResponse, Request, response\\nfrom .view import bp\\nfrom . import scheduler\\n\\napp = Sanic(__name__)\\n\\n# lifecycle hook - åœ¨ server é‹è¡Œä¹‹å‰å°‡ instance è¨»å†Šé€² context.\\n@app.before_server_start\\nasync def startup(app: Sanic):\\n    scheduler.setup(app)\\n\\napp.blueprint(bp)\\n\u003C/code>\u003C/pre>\\n\u003Cul>\\n\u003Cli>\u003Cstrong>scheduler.py\u003C/strong>\u003C/li>\\n\u003C/ul>\\n\u003Cpre>\u003Ccode class=\\\"language-python\\\">from sanic import Sanic\\n\\nfrom .struct import AppScheduler\\n\\nSERVICE_CODE = &quot;app_scheduler&quot;\\n\\ndef get() -&gt; AppScheduler:\\n    app = Sanic.get_app()\\n    # ä½¿ç”¨ getattr å–å¾— app.ctx ä¸­çš„ instance\\n    return getattr(app.ctx, SERVICE_CODE)\\n\\ndef setup(app: Sanic) -&gt; AppScheduler:\\n    app = Sanic.get_app()\\n    scheduler = AppScheduler(app)\\n    # ä½¿ç”¨ setattr å°‡ instance å¯«å…¥ app.ctx\\n    setattr(app.ctx, SERVICE_CODE, scheduler)\\n    return scheduler\\n\u003C/code>\u003C/pre>\\n\u003Cul>\\n\u003Cli>\u003Cstrong>view.py\u003C/strong>\u003C/li>\\n\u003C/ul>\\n\u003Cpre>\u003Ccode class=\\\"language-python\\\">from sanic import Blueprint, HTTPResponse, Request, response\\nfrom . import scheduler\\n\\nbp = Blueprint(&quot;peon&quot;)\\ndef typed(request: Request) -&gt; HTTPResponse:\\n    &quot;&quot;&quot;\\n    get Done(sync)\\n    \\n    :param reuqest [sanic.Request]\\n    &quot;&quot;&quot;\\n    _scheudler = scheduler.get()\\n    return response.text(&quot;Done&quot;)\\n\u003C/code>\u003C/pre>\\n\u003Cp>ç¯„ä¾‹ä¸­ä½¿ç”¨ \u003Ccode>@app.before_server_start\u003C/code> åœ¨é‹è¡Œä¹‹å‰å°‡ AppScheduler åµŒå…¥ app.ctx å…§ã€‚ ä¸¦åœ¨ handler ä¸­é \u003Ccode>scheduler.get()\u003C/code> å°‡å…¶å¾ app.ctx ä¸­å–å‡ºï¼Œè—‰æ­¤é‡è¤‡åˆ©ç”¨ instanceã€‚\u003C/p>\\n\u003Ch2 id=\\\"listener-lifecycle\\\" class=\\\"heading-item\\\">Listener (LifeCycle)\u003C/h2>\u003Cp>Sanic åŒ…å« 8 å€‹ Hookï¼š\u003C/p>\\n\u003Cp>\u003Cstrong>åªåœ¨ sanic app å»ºç«‹/åœæ­¢æ™‚åŸ·è¡Œä¸€æ¬¡:\u003C/strong>\u003C/p>\\n\u003Cul>\\n\u003Cli>main_process_start\u003C/li>\\n\u003Cli>main_process_stop\u003C/li>\\n\u003C/ul>\\n\u003Cp>\u003Cstrong>æ¯å€‹ worker éƒ½æœƒåŸ·è¡Œä¸€æ¬¡\u003C/strong>\u003C/p>\\n\u003Cul>\\n\u003Cli>before_server_start\u003C/li>\\n\u003Cli>after_server_start\u003C/li>\\n\u003Cli>before_server_stop\u003C/li>\\n\u003Cli>after_server_stop\u003C/li>\\n\u003C/ul>\\n\u003Cp>\u003Cstrong>ç•¶ auto_reload è¢«é–‹å•Ÿæ™‚ï¼Œæ¯æ¬¡ reload å°±æœƒåŸ·è¡Œä¸€æ¬¡\u003C/strong>\u003C/p>\\n\u003Cul>\\n\u003Cli>reload_process_start\u003C/li>\\n\u003Cli>reload_process_stop\u003C/li>\\n\u003C/ul>\\n\u003Cpre>\u003Ccode class=\\\"language-python\\\">@app.reload_process_start\\nasync def reload_start(*_):\\n    print(&quot;&gt;&gt;&gt;&gt;&gt;&gt; reload_start &lt;&lt;&lt;&lt;&lt;&lt;&quot;)\\n\\n\\n@app.main_process_start\\nasync def main_start(*_):\\n    print(&quot;&gt;&gt;&gt;&gt;&gt;&gt; main_start &lt;&lt;&lt;&lt;&lt;&lt;&quot;)\\n\u003C/code>\u003C/pre>\\n\u003Cul>\\n\u003Cli>\u003Ccode>main_process_start\u003C/code> ç¶“å¸¸ç”¨æ–¼åˆå§‹åŒ–åƒ…èƒ½åˆå§‹åŒ–ä¸€æ¬¡çš„æ™‚å€™ï¼ˆè¨­ç½®é ç«¯çš„ webhook)\u003C/li>\\n\u003Cli>\u003Ccode>before_server_start\u003C/code> åŠ \u003Ccode>after_server_start\u003C/code> å¸¸ç”¨æ–¼å»ºç«‹å¯é‡è¤‡ä½¿ç”¨çš„ instance ä¸¦ä¸”é™„åŠ è‡³ app.ctx ä½œç‚ºå¸¸é§ service ä½¿ç”¨ã€‚\u003C/li>\\n\u003Cli>\u003Ccode>before_server_stop\u003C/code> ç”¨æ–¼é—œé–‰å„ service çš„é€£æ¥ä¸¦æ¸…é™¤è³‡æ–™ã€‚\u003C/li>\\n\u003C/ul>\\n\u003Ch2 id=\\\"æ‡‰ç”¨ç¯„ä¾‹\\\" class=\\\"heading-item\\\">æ‡‰ç”¨ç¯„ä¾‹\u003C/h2>\u003Cblockquote>\\n\u003Cp>\u003Cstrong>Sanic Example\u003C/strong>\u003Cbr/>\\nGithub: \u003Ca href=\\\"https://github.com/saweima12/sanic-example\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopenner\\\">é»æˆ‘é€²å…¥\u003C/a>\u003C/p>\\n\u003C/blockquote>\\n\u003Ch2 id=\\\"tldr\\\" class=\\\"heading-item\\\">TL;DR\u003C/h2>\u003Cul>\\n\u003Cli>Sanic æ˜¯ Python 3.8 ç‰ˆæœ¬ä»¥ä¸Šçš„è¼•é‡ Web æ¡†æ¶ï¼Œæ”¯æ´ async / await çš„éåŒæ­¥ç‰¹æ€§ã€‚\u003C/li>\\n\u003Cli>æ¨è–¦ä½¿ç”¨ Sanic CLI é‹è¡Œ Server ï¼Œåœ¨ç’°å¢ƒé…ç½®ä¸Šæœ‰æ›´å¤šçš„å½ˆæ€§ã€‚\u003C/li>\\n\u003Cli>Handler æ˜¯è™•ç† Request çš„åŸºæœ¬å–®å…ƒï¼Œæœƒ\u003Cstrong>è‡³å°‘æ¥æ”¶ä¸€å€‹ Request ç‰©ä»¶ä¸¦è¿”å› HttpResponse ç‰©ä»¶\u003C/strong>ã€‚\u003C/li>\\n\u003Cli>æ‡‰è©²\u003Cstrong>ç›¡é‡ä½¿ç”¨ async / await\u003C/strong> è™•ç† handler é‚è¼¯ï¼Œé¿å…åŸ·è¡Œç·’é˜»å¡ã€å¢åŠ é‹ä½œæ•ˆç‡ã€‚\u003C/li>\\n\u003Cli>Routing ç”¨æ–¼\u003Cstrong>å°‡è·¯ç”±èˆ‡ Handler é€²è¡Œç¶å®š\u003C/strong>ï¼Œç•¶ Server æ¥æ”¶åˆ°æŒ‡å®šçš„è·¯å¾‘æ™‚ï¼Œæœƒå°‡è³‡æ–™æ‰“åŒ…æˆ Request é€è‡³å°æ‡‰çš„ Handlerã€‚\u003C/li>\\n\u003Cli>App Context ç”¨æ–¼\u003Cstrong>å­˜æ”¾å¸Œæœ›é‡è¤‡ä½¿ç”¨çš„ instance\u003C/strong>ï¼Œåƒæ˜¯è³‡æ–™åº«é€£æ¥ã€æ’ç¨‹å™¨ç­‰ã€‚\u003C/li>\\n\u003C/ul>\\n\",\"headings\":[{\"depth\":2,\"text\":\"æ¡†æ¶ç‰¹æ€§\",\"id\":\"æ¡†æ¶ç‰¹æ€§\"},{\"depth\":2,\"text\":\"å»ºç«‹åŸºæœ¬çµæ§‹\",\"id\":\"å»ºç«‹åŸºæœ¬çµæ§‹\"},{\"depth\":3,\"text\":\"é€é app.run() é‹è¡Œ\",\"id\":\"é€é-apprun-é‹è¡Œ\"},{\"depth\":3,\"text\":\"é€é CLI é‹è¡Œ(æ¨è–¦)\",\"id\":\"é€é-cli-é‹è¡Œæ¨è–¦\"},{\"depth\":2,\"text\":\"Handler\",\"id\":\"handler\"},{\"depth\":2,\"text\":\"Routing\",\"id\":\"routing\"},{\"depth\":3,\"text\":\"Blueprint\",\"id\":\"blueprint\"},{\"depth\":2,\"text\":\"App Registry\",\"id\":\"app-registry\"},{\"depth\":2,\"text\":\"App Context\",\"id\":\"app-context\"},{\"depth\":2,\"text\":\"Listener (LifeCycle)\",\"id\":\"listener-lifecycle\"},{\"depth\":2,\"text\":\"æ‡‰ç”¨ç¯„ä¾‹\",\"id\":\"æ‡‰ç”¨ç¯„ä¾‹\"},{\"depth\":2,\"text\":\"TL;DR\",\"id\":\"tldr\"}]}"}</script></div>
	</body>
</html>

<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../../../logo.png" />
		<link rel="sitemap" type="application/xml" href="/sitemap.xml" />
		<link rel="alternate" type="application/atom+xml" href="/atom.xml" />
		<link rel="alternate" type="application/feed+xml" href="/feed.xml" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta http-equiv="content-security-policy" content=""><title>ç”¨ AIOGram å»ºç«‹æ©Ÿå™¨äººå°ˆæ¡ˆ â€” Telegram Bot é–‹ç™¼é›œè«‡ï¼ˆä¸€ï¼‰ - Saweicore Lab - ç¨‹å¼é–‹ç™¼ | ç¶²ç«™æ¶è¨­ | å¹£åœˆé›œè«‡ | å„é …é›œç‡´é›†æ•£åœ°</title><meta name="twitter:card" content="summary" data-svelte="svelte-f1lzu5"><meta name="twitter:site" content="@saweima12" data-svelte="svelte-f1lzu5"><meta name="twitter:title" content="ç”¨ AIOGram å»ºç«‹æ©Ÿå™¨äººå°ˆæ¡ˆ â€” Telegram Bot é–‹ç™¼é›œè«‡ï¼ˆä¸€ï¼‰ - Saweicore Lab - ç¨‹å¼é–‹ç™¼ | ç¶²ç«™æ¶è¨­ | å¹£åœˆé›œè«‡ | å„é …é›œç‡´é›†æ•£åœ°" data-svelte="svelte-f1lzu5"><meta name="twitter:description" data-svelte="svelte-f1lzu5"><meta name="twitter:url" content="https://saweicore.com/posts/2022/07/create-aiogram-project" data-svelte="svelte-f1lzu5"><meta property="og:url" content="https://saweicore.com/posts/2022/07/create-aiogram-project" data-svelte="svelte-f1lzu5"><meta property="og:locale" content="zh_TW" data-svelte="svelte-f1lzu5"><meta property="og:type" content="article" data-svelte="svelte-f1lzu5"><meta property="og:title" content="ç”¨ AIOGram å»ºç«‹æ©Ÿå™¨äººå°ˆæ¡ˆ â€” Telegram Bot é–‹ç™¼é›œè«‡ï¼ˆä¸€ï¼‰" data-svelte="svelte-f1lzu5"><meta property="og:site_name" content="Saweicore Lab - ç¨‹å¼é–‹ç™¼ | ç¶²ç«™æ¶è¨­ | å¹£åœˆé›œè«‡ | å„é …é›œç‡´é›†æ•£åœ°" data-svelte="svelte-f1lzu5"><meta property="og:description" content="å»£å‘Šæ©Ÿå™¨äººä¸€å¤§å †ã€é¬§ç¾¤ä»½å­ä¸€å€‹æ¥ä¸€å€‹ï¼Ÿåˆæˆ–æ˜¯æƒ³è¦åšäº›èŠå¤©æ©Ÿå™¨äººå°å·¥å…·ï¼Ÿé€é AIOGram å¿«é€Ÿé–‹ç™¼ Python Telegram Botï¼Œç”¨æµç¨‹è‡ªå‹•åŒ–è§£æ±ºæ‰€æœ‰éº»ç…©äº‹æƒ…ã€‚" data-svelte="svelte-f1lzu5">
		<meta name="description" content="å»£å‘Šæ©Ÿå™¨äººä¸€å¤§å †ã€é¬§ç¾¤ä»½å­ä¸€å€‹æ¥ä¸€å€‹ï¼Ÿåˆæˆ–æ˜¯æƒ³è¦åšäº›èŠå¤©æ©Ÿå™¨äººå°å·¥å…·ï¼Ÿé€é AIOGram å¿«é€Ÿé–‹ç™¼ Python Telegram Botï¼Œç”¨æµç¨‹è‡ªå‹•åŒ–è§£æ±ºæ‰€æœ‰éº»ç…©äº‹æƒ…ã€‚" data-svelte="svelte-f1lzu5">
	<link href="../../../_app/immutable/assets/+layout-eed564a7.css" rel="stylesheet">
	<link href="../../../_app/immutable/assets/+page-7ed394ec.css" rel="stylesheet">
	<link rel="modulepreload" href="../../../_app/immutable/start-34fd70cd.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/index-e6965666.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/index-e127beab.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/preload-helper-aa6bc0ce.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/singletons-dbe501d2.js">
	<link rel="modulepreload" href="../../../_app/immutable/components/pages/_layout.svelte-db83af4e.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/store-465521c3.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/helper-a645ffda.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/stores-4922191d.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/navigation-a14b4e4e.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/_commonjsHelpers-094ef602.js">
	<link rel="modulepreload" href="../../../_app/immutable/modules/pages/_layout.ts-4774ee04.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/route-58ec6f73.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/_layout-5a184ceb.js">
	<link rel="modulepreload" href="../../../_app/immutable/components/pages/posts/_year_/_month_/_slug_/_page.svelte-d45c6961.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/formater-faf389fa.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/calender-ce03e571.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/colors-e3ddc188.js">
	<link rel="modulepreload" href="../../../_app/immutable/modules/pages/posts/_year_/_month_/_slug_/_page.ts-8ee2144c.js">
	<link rel="modulepreload" href="../../../_app/immutable/chunks/_page-a23fdb74.js">
	</head>
	<body>
		<div>


<div class="wrapper-container"><div class="transition-all duration-200 min-h-screen main-wrapper"><div class="fixed top-0 w-screen wrapper">

<nav class="py-2 px-2 top-navbar svelte-1jv9zmu"><div class="flex pl-1 items-center navbar-container svelte-1jv9zmu"><div class="lg:hidden w-30 px-2"><div class="menu-button-wrapper"><div class="menu-button-container"><div class="menu-button"></div></div></div></div>

		<a sveltekit:prefetch class="flex raleway-font site-title" href="/"><div class="logo svelte-1jv9zmu"><img width="36" height="36" src="/logo.png" alt="Saweicore Lab"></div>
			
			<div class="hidden md:flex px-2 letter-title-font title svelte-1jv9zmu">Saweicore Lab</div></a>
	
		<div class="grow spacer"></div>

		<div class="hidden lg:flex items-center"><ul class="h-full flex flex-row nav-list svelte-1jv9zmu"><li class="nav-item mr-5 px-2 svelte-1jv9zmu"><a sveltekit:prefetch href="/journal" alt="" class="w-full h-full"><div class="flex items-center nav-item-block svelte-1jv9zmu"><div class="item-name">Journal</div>
							</div>
					</a>
				</li><li class="nav-item mr-5 px-2 svelte-1jv9zmu"><a sveltekit:prefetch href="/about" alt="" class="w-full h-full"><div class="flex items-center nav-item-block svelte-1jv9zmu"><div class="item-name">About</div>
							</div>
					</a>
				</li><li class="nav-item mr-5 px-2 svelte-1jv9zmu"><a href="http://github.com/saweima12" alt="" class="w-full h-full"><div class="flex items-center nav-item-block svelte-1jv9zmu"><div class="item-name">Github</div>
							<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div>
					</a>
				</li></ul>
			<button class="flex text-xl letter-content-font mr-1 theme-switch svelte-1jv9zmu"><div class="icon-base w-6"><svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>ic_fluent_dark_theme_24_filled</title><desc>Created with Sketch.</desc><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill="#212121" fill-rule="nonzero"><path fill="currentColor" d="M12,22 C17.5228475,22 22,17.5228475 22,12 C22,6.4771525 17.5228475,2 12,2 C6.4771525,2 2,6.4771525 2,12 C2,17.5228475 6.4771525,22 12,22 Z M12,20 L12,4 C16.418278,4 20,7.581722 20,12 C20,16.418278 16.418278,20 12,20 Z" id="ğŸ¨-Color"></path></g></g></svg></div></button></div>

		<div class="lg:hidden search-icon"><div class="nav-search mr-2 svelte-18cfe79"><div class="flex self-center justify-center w-6 label-icon"><svg viewBox="0 0 24 24" aria-hidden="true" class="svelte-1h287kj"><path fill="currentColor" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"></path></svg></div>
</div></div></div>


</nav></div>

		<div class="flex flex-col justify-between main-container svelte-agtcg5"><div class="w-full content-wrapper"><main class="mx-auto min-h-screen content-container"><div>

<div class="my-10 post-page wrapper"><div class="post-container"><header class="mx-6 mb-4"><h1 class="font-bold letter-title-font post-title">ç”¨ AIOGram å»ºç«‹æ©Ÿå™¨äººå°ˆæ¡ˆ â€” Telegram Bot é–‹ç™¼é›œè«‡ï¼ˆä¸€ï¼‰</h1>

			<div class="flex flex-row items-center mt-2 created-date"><div class="icon-base w-5"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line fill="currentColor" x1="16" y1="2" x2="16" y2="6"></line><line fill="currentColor" x1="8" y1="2" x2="8" y2="6"></line><line fill="currentColor" x1="3" y1="10" x2="21" y2="10"></line></svg></div>
				<time class="flex self-center ml-2">2022-07-23</time></div>

			<div class="mt-4 flex flex-row post-tag-list"><div class="post-tag-item"><a sveltekit:prefetch href="/tags/bot">bot</a>
					</div><div class="post-tag-item"><a sveltekit:prefetch href="/tags/python">python</a>
					</div><div class="post-tag-item"><a sveltekit:prefetch href="/tags/programing">programing</a>
					</div></div></header>

		<article class="content"><!-- HTML_TAG_START --><p>åˆå®‰æ—…äººï¼Œé€™è£¡æ˜¯ä¸€å€‹æœˆæ²’æœ‰æ›´æ–°æ–‡ç« çš„ Saweimaã€‚ä¸çŸ¥é“æ—…äººæœ‰æ²’æœ‰åœ¨ Telegram å…¬é–‹ç¾¤çµ„é‡åˆ°éæƒ¡æ„é¨·æ“¾äººå£«å‘¢ï¼Ÿæ™‚ä¸æ™‚çš„é–‹æ–°å¸³è™Ÿè·‘é€²ç¾¤çµ„è²¼ä¸€äº›æœƒè®“äººæ„Ÿåˆ°å™å¿ƒçš„åœ–ç‰‡ï¼Œè¸¢å®Œéä¸€é™£å­åˆå†æ¬¡æ•…æŠ€é‡æ–½ï¼ŒçŒ¶å¦‚èŸ‘è‚ä¸€èˆ¬ï¼Œæ®ºä¹Ÿæ®ºä¸å®Œã€‚</p>
<p>è€ƒé‡åˆ°ç®¡ç†å“¡ä¸å¯èƒ½æ™‚æ™‚åˆ»åˆ»éƒ½åœ¨ã€åˆªé™¤åœ–ç‰‡æ™‚ç®¡ç†å“¡è‡ªèº«ä¹Ÿä¸å¯é¿å…çš„æœƒå—åˆ°ç²¾ç¥æ”»æ“Šï¼Œäººå·¥è™•ç†é¡¯ç„¶ä¸æ˜¯ä¸€ç¨®å¥½è¾¦æ³•ã€‚ç”±æ–¼éœ€æ±‚çš„æ€¥è¿«æ€§ï¼ŒèŠ±äº†å¹¾é€±æ™‚é–“ç ”ç©¶åŠç·¨å¯«æ©Ÿå™¨äººï¼Œåœ¨é€™é‚Šè¨˜éŒ„ä¸‹è‡ªå·±ç”¨åˆ°çš„æ±è¥¿å€‘ã€‚</p>
<h2 id="aiogram" class="heading-item">AIOGram</h2><p>AIOGram æ˜¯ Telegram Bot API çš„ Python åŒ…è£å™¨ï¼Œç”¨æ–¼å°‡ç¹ç‘£çš„ HTTP API å‘¼å«æµç¨‹åŒ…è£ç‚ºç¨‹å¼ç‰©ä»¶ä¸¦è§£æ API çš„å›å‚³è³‡æ–™ï¼Œè®“æ“ä½œæµç¨‹èˆ‡ç¨‹å¼èªå¥ä¸€æ¨£ç›´è§€ã€‚</p>
<blockquote>
<p><strong>AIOGram</strong> <br/>
Github: <a href="https://github.com/aiogram/aiogram" target="_blank" rel="noreferrer noopenner">é»æˆ‘é€²å…¥</a> <br/>
å®˜æ–¹æ–‡æ“‹: <a href="https://docs.aiogram.dev/en/latest/" target="_blank" rel="noreferrer noopenner">é»æˆ‘é€²å…¥</a> <br/></p>
</blockquote>
<p>ç‰¹æ€§ï¼š</p>
<ul>
<li>ä½¿ç”¨ Python 3.7 ä»¥ä¸Šç‰ˆæœ¬ã€‚</li>
<li>é€é asyncio åŠ aiphttp å¯¦ä½œï¼Œæ”¯æ´ Asynchronous ï¼ˆç•°æ­¥/éåŒæ­¥ï¼‰èª¿ç”¨ã€‚</li>
<li>å…§ç½® API å°åŒ…è§£æåŠå®šç¾©å‹åˆ¥ï¼Œçœå»ç ”ç©¶å°åŒ…çµæ§‹çš„æ™‚é–“ã€‚</li>
</ul>
<p>å…¶ä»–çš„ API åŒ…è£å™¨å¯åƒè€ƒ <a href="https://core.telegram.org/bots/samples" target="_blank" rel="noreferrer noopenner"><strong>Telegram çš„å®˜æ–¹åˆ—è¡¨</strong></a></p>
<h2 id="è¨»å†Š-telegram-bot" class="heading-item">è¨»å†Š Telegram Bot</h2><p>åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œå¿…é ˆå…ˆé€é Telegram Bot Father è¨»å†Šæ–°çš„ bot å¸³æˆ¶ã€‚</p>
<img class="lightbox" src="https://media.saweicore.com/blog/create-aiogram-project/register-tg-bot.jpg" height="500" />


<ul>
<li>åŠ å…¥æœ‰è—è‰²å‹¾å‹¾ï¼ˆè­‰æ˜ç‚ºå®˜æ–¹å¸³è™Ÿï¼‰çš„ BotFather</li>
<li>è¼¸å…¥æŒ‡ä»¤ <code>/newbot</code> è¨»å†Šæ–°çš„ Bot</li>
<li>ç¬¬ä¸€æ¬¡è¼¸å…¥ Bot çš„åç¨±</li>
<li>ç¬¬äºŒæ¬¡è¼¸å…¥ Bot çš„å¸³è™Ÿ</li>
</ul>
<p>ä»¥ä¸Šæµç¨‹éƒ½æˆåŠŸå¾Œå°±å¾Œæœƒå–å¾—ä½¿ç”¨ API çš„ TOKEN å¦‚ï¼š<code>5292723007:AAE-APVbUkZgOZ6CVb4GM_KfV7CtE5dgLmw</code>ï¼Œé€™æ®µéœ€è¦ä¿å­˜å¥½ï¼Œæœªä¾†æ‰€æœ‰æ“ä½œéƒ½æœƒéœ€è¦ç”¨åˆ°ã€‚</p>
<h2 id="å»ºç«‹åŸºæœ¬çµæ§‹" class="heading-item">å»ºç«‹åŸºæœ¬çµæ§‹</h2><p>AIOGram å„ Module è² è²¬çš„åŠŸèƒ½ï¼š</p>
<ul>
<li><code>Bot</code> class å°‡æ‰€æœ‰ Telegram Bot API çš„æŒ‡ä»¤åŒ…è£æˆ function å½¢å¼ï¼Œä¸»è¦è² è²¬å‚³é€ request çµ¦ Telegram ä¼ºæœå™¨ã€‚</li>
<li><code>Dispatcher</code> class è² è²¬æ¥æ”¶æ‰€æœ‰é€é Webhook æ”¶åˆ°çš„è¨Šæ¯ï¼Œä¸¦è½‰æ›ç‚ºå°æ‡‰çš„ Objectã€‚</li>
<li><code>types</code> module åº•ä¸‹åŒ…å«æ‰€æœ‰å‹åˆ¥åŠå…¶ç›¸é—œçš„è¼”åŠ© Functionï¼Œå¦‚ Updateã€Messageã€‚</li>
</ul>
<p>é‹è¡Œçš„ä¸»è¦æµç¨‹ï¼š
-&gt; æ¥æ”¶ Telegram çš„ Update è¨Šæ¯
-&gt; å‚³å…¥ Dispatcher é€²è¡Œåˆ†é¡
-&gt; Dispatcher å°‡åˆ†é¡å¾Œçš„è¨Šæ¯ç™¼é€çµ¦è¨»å†Šçš„ Handler 
-&gt; Handler é€²è¡Œè™•ç†å¾Œå›å‚³ HTTP Response çµ¦ Telegram ä¼ºæœå™¨ï¼ˆå¦‚æœæ”¶åˆ°é 200 çš„ status code æœƒç­‰å¾…ä¸€å®šæ™‚é–“å¾Œé‡æ–°å‚³é€ï¼‰</p>
<p><strong>Update è³‡è¨Šçš„å–å¾—æ–¹å¼æœ‰ä»¥ä¸‹å…©ç¨®ï¼š</strong></p>
<h3 id="ä½¿ç”¨-polling" class="heading-item">ä½¿ç”¨ Polling</h3><pre><code class="language-py"># å°å…¥ Aiogram åŒ…
from aiogram import Bot
from aiogram.types import Message, ContentTypes
from aiogram.dispatcher import Dispatcher
from aiogram.utils.executor import start_polling

# è¨˜éŒ„ BOT_TOKEN ä¸¦ä¸”å»ºç«‹ Bot ç‰©ä»¶
BOT_TOKEN = &quot;5292723007:AAE-APVbUkZgOZ6CBGM_KfV7CtE5dgLmw&quot;
bot = Bot(BOT_TOKEN)
# å»ºç«‹ Bot çš„åˆ†ç™¼å™¨ï¼ˆæ”¶åˆ°çš„ Data æœƒè¢«å‚³å…¥é€™è£¡
dp = Dispatcher(bot)

# Process start command
@dp.message_handler(commands=[&#39;start&#39;])
async def on_start_command(message: Message):  
    print(&quot;on start command&quot;)

# Process all messages except start command
@dp.message_handler(content_types=ContentTypes.ANY)
async def on_message(message: Message):
    await message.reply(message.from_user.id)

async def on_startup(dispatcher: Dispatcher):
    print(&quot;startup&quot;)

async def on_shutdown(dispatcher: Dispatcher):
    print(&quot;shutdown&quot;)


if __name__ == &quot;__main__&quot;:
    start_polling(dp, on_startup=on_startup, on_shutdown=on_shutdown)
</code></pre>
<p>Polling æ–¹å¼æ˜¯é€éä¸€å€‹è¿´åœˆï¼Œå®šæœŸçš„å‘¼å« Telegram Bot API çš„ getUpdate æ–¹æ³•å–å¾—æ–°çš„è¨Šæ¯ï¼Œä¸¦å°‡å…¶å‚³å…¥ dispatcher é€²è¡Œåˆ†ç™¼ï¼Œç›´åˆ°è¢«ä¸­æ–·ç‚ºæ­¢ã€‚</p>
<ul>
<li><code>Bot</code> é¡è² è²¬èˆ‡ Bot API æºé€šï¼ŒåŒ…å« <strong>send_message</strong> æˆ– <strong>deleted_message</strong> ç­‰ä¸»å‹•æ“ä½œçš„ method ã€‚</li>
<li><code>Dispatcher</code> é¡è² è²¬<strong>æ¥æ”¶ API çš„ Update è¨Šæ¯</strong>ï¼ˆä¸è«–æ˜¯é€é Polling é‚„æ˜¯ Webhook æ¥æ”¶çš„ï¼‰ä¾æ“šç‰¹å¾µåˆ†ç™¼çµ¦å„ message_handler ã€‚</li>
<li><code>Message</code> é¡æ˜¯<strong>é€é Dispatcher åˆ†é¡éå¾Œçš„è¨Šæ¯ç‰©ä»¶</strong>ï¼ŒåŒ…å« message_id , chat_id, user_id ç­‰é—œéµçš„åˆ¤æ–·è¨Šæ¯ï¼Œ AIOGram ä¹Ÿæœ‰åœ¨æ­¤åŸºç¤ä¸Šå¯¦ä½œè¨±å¤šè¼”åŠ©æ–¹æ³•ã€‚</li>
<li><code>dp.message_handler()</code> å¯ä»¥<strong>å°‡åº•ä¸‹çš„ function è¨»å†Šç‚ºè™•ç†å™¨</strong>ï¼Œä¸¦ä¸”é€éåƒæ•¸å¦‚: <strong>content_types</strong> ã€<strong>commands</strong> è¨­å®šåªæ¥åŒ…å«å“ªäº›ç‰¹å¾µçš„è¨Šæ¯ã€‚</li>
<li><code>start_polling</code> ç”¨æ–¼åŸ·è¡Œ<strong>è¼ªè©¢æŠ“å– Telegram çš„è¨Šæ¯</strong>æ›´æ–°ã€‚</li>
</ul>
<h3 id="ä½¿ç”¨-webhook" class="heading-item">ä½¿ç”¨ Webhook</h3><pre><code class="language-py">from aiogram import Bot
from aiogram.types import Message, ContentTypes
from aiogram.dispatcher import Dispatcher
from aiogram.utils.executor import start_webhook

BOT_TOKEN = &quot;5292723007:AAE-APVbUkZgOZ6CBGM_KfV7CtE5dgLmw&quot;

# WEBHOOK SETTING
WEBHOOK_DOMAIN = &quot;https://68dc-211-23-21-139.jp.ngrok.io&quot;
WEBHOOK_PATH=&quot;/api&quot;
WEBHOOK_URI=f&quot;{WEBHOOK_DOMAIN}{WEBHOOK_PATH}&quot;

# WEBHOST SETTING
WEB_HOST = &quot;0.0.0.0&quot; # or ip
WEB_HOST_PORT = 8000

bot = Bot(BOT_TOKEN)
dp = Dispatcher(bot)

# Process start command
@dp.message_handler(commands=[&#39;start&#39;])
async def on_start_command():  
    print(&quot;on start command&quot;)

# Process all messages except start command
@dp.message_handler(content_types=ContentTypes.ANY)
async def on_message(message: Message):
    await message.reply(message.from_user.id)


async def on_startup(dispatcher: Dispatcher):
    print(&quot;startup&quot;)
    await bot.set_webhook(WEBHOOK_URI)


async def on_shutdown(dispatcher: Dispatcher):
    print(&quot;shutdown&quot;)
    await bot.delete_webhook()


if __name__ == &quot;__main__&quot;:
    start_webhook(dispatcher=dp, 
                webhook_path=WEBHOOK_PATH,
                on_startup=on_startup,
                on_shutdown=on_shutdown,
                skip_updates=True,
                host=WEB_HOST, 
                port=WEB_HOST_PORT)
</code></pre>
<p>Webhook æ–¹å¼æ˜¯åœ¨å•Ÿå‹•æ™‚é€šçŸ¥ Telegram ä¼ºæœå™¨å°‡æ–°è¨Šæ¯å‚³è¼¸è‡³å°æ‡‰çš„ URLï¼Œé€é HTTP æ¥å£ä¾†æ¥æ”¶è³‡è¨Šã€‚</p>
<p>å¤§å¤šæ•¸çµæ§‹èˆ‡ä½¿ç”¨ Polling æ™‚ç›¸åŒï¼Œå› æ­¤é€™é‚Šåƒ…åˆ—èˆ‰å·®ç•°çš„åœ°æ–¹ã€‚</p>
<ul>
<li><code>bot.set_webook</code> ç”¨æ–¼é€šçŸ¥ Telegram ä¼ºæœå™¨ï¼Œå°‡è¨Šæ¯å‚³è¼¸åˆ°è¨»å†Šçš„ URLã€‚</li>
<li><code>bot.delete_webhook</code> ç”¨æ–¼é—œé–‰æ™‚é€šçŸ¥ Telegram ä¼ºæœå™¨åœæ­¢è¼¸é€è¨Šæ¯è‡³è¨»å†Šçš„ URL</li>
<li><code>start_webhook</code> ç”¨æ–¼å•Ÿå‹• AIOGram å…§å»ºçš„å°å‹ HTTP Server ç›£è½ webhook_path åƒæ•¸æŒ‡å®šçš„è·¯å¾‘ã€‚hostã€port ç”¨æ–¼é…ç½®å•Ÿå‹•çš„ host èˆ‡ portã€‚</li>
</ul>
<blockquote>
<ul>
<li>è¼ƒç‚ºæ¨è–¦ä½¿ç”¨ Webhook æ–¹å¼æ¥æ”¶ Update è¨Šæ¯ï¼Œå¯ä»¥ç¯€çœé »ç¹ç™¼é€å°åŒ…çš„æµé‡åŠä¸æ–·è¼ªè©¢è¨ˆç®—æè€—çš„é›»è…¦è³‡æºã€‚</li>
<li>ä¸éè¦ä»¥æ­¤ä½œç‚ºæ¥æ”¶è¨Šæ¯æ–¹å¼ï¼Œéœ€è¦ä¸€å€‹æ”¯æ´ HTTPS çš„ç¶²åŸŸã€‚å› æ­¤é‚„æ˜¯ä¾æ“šæ‰‹é‚Šçš„è³‡æºæ±ºå®šã€‚</li>
</ul>
</blockquote>
<h2 id="å¦‚ä½•åœ¨æœ¬åœ°ç«¯é€²è¡Œæ¸¬è©¦ï¼Ÿ" class="heading-item">å¦‚ä½•åœ¨æœ¬åœ°ç«¯é€²è¡Œæ¸¬è©¦ï¼Ÿ</h2><p>å¦‚æœä½¿ç”¨ Polling æ¥æ”¶è³‡è¨Šçš„è©±å€’é‚„å¥½ï¼Œä½†ä½¿ç”¨ Webhook çš„è©±ï¼Œæœ€å…ˆé‡ä¸Šçš„å•é¡Œå°±æ˜¯æ€éº¼é€²è¡Œæ¸¬è©¦ï¼Œç¸½ä¸èƒ½æ¯æ¬¡éƒ½å…ˆç™¼å¸ƒåˆ°é ç«¯ä¼ºæœå™¨ï¼Œåˆæˆ–æ˜¯å…ˆæ”¹æˆ Polling è¦ç™¼å¸ƒæ™‚æ‰æ”¹å›ä¾†ï¼Œå¾ˆæ²’æœ‰æ•ˆç‡ï¼Œé€™æ™‚å€™å°±å¯ä»¥è€ƒæ…®ä½¿ç”¨åå‘ä»£ç†å·¥å…·ã€‚</p>
<h3 id="ngrok" class="heading-item">Ngrok</h3><blockquote>
<p><strong>Ngrok</strong> <br/>
<a href="https://ngrok.com/" target="_blank" rel="noreferrer noopenner">https://ngrok.com/</a></p>
</blockquote>
<p>Ngrok æ˜¯ä¸€æ¬¾æœ‰æä¾›å…è²»æ–¹æ¡ˆçš„åå‘ä»£ç†å·¥å…·ï¼Œä¸¦ä¸”æ”¯æ´ HTTPS è½‰ç™¼ï¼Œå¯ä»¥ç”¨æ–¼æœ¬åœ°ç«¯çš„ Webhook æ¸¬è©¦ï¼Œå®Œå…¨æ»¿è¶³é€™æ¬¡çš„éœ€æ±‚ï¼Œä½¿ç”¨å‰éœ€è¦å…ˆåœ¨å®˜ç¶²è¨»å†Šå¸³è™Ÿå–å¾— AUTH_TOKEN ä¸¦ä¸‹è¼‰å°æ‡‰ä½œæ¥­ç³»çµ±çš„æª”æ¡ˆã€‚è¼¸å…¥ä»¥ä¸‹æŒ‡ä»¤è¨­å®š AUTH_TOKEN</p>
<pre><code class="language-sh">ngrok config add-authtoken {AUTH_TOKEN}
</code></pre>
<p>è¨­å®šå®Œæˆå¾Œï¼Œå†ä¾†åªéœ€è¦è¼¸å…¥ä»¥ä¸‹æŒ‡ä»¤å³å¯å°‡è‡ªå·±çš„ PORT 8000 ç¶å®šåˆ° ngrok æä¾›çš„ domain ä¸Šã€‚</p>
<pre><code class="language-sh">ngrok http 8000
</code></pre>
<p>æˆåŠŸå¾Œå¦‚ä¸‹ï¼š</p>
<img class="lightbox" src="https://media.saweicore.com/blog/create-aiogram-project/ngrok-test.jpg" height="195"/>

<p>åœ–ä¸­çš„ <code>https://928c-211-23-21-139.ngrok.io</code> å°±æ˜¯é€é ngrok å–å¾—çš„ URL DOMAINï¼Œå®ƒå°±ç›¸ç•¶æ–¼é€£æ¥åˆ°æœ¬æ©Ÿçš„ port 8000 ã€‚</p>
<p>ç•¶ä¸€åˆ‡å°±ç·’ï¼Œå°±å¯ä»¥è©¦è‘—èˆ‡æ©Ÿå™¨äººå°è©±ï¼Œå¦‚æœæŒ‰ç…§ä¸Šé¢çš„ç¯„ä¾‹ï¼Œæ—…äººæ‡‰è©²æœƒæ”¶åˆ°ä¸€ä¸²ç¥å¥‡çš„æ•¸å­—ï¼Œé‚£ä¾¿æ˜¯è‡ªå·±çš„ user_id ã€‚</p>
<h2 id="å¦‚æœä¸ä½¿ç”¨åŒ…è£å™¨çš„è©±ï¼Ÿ" class="heading-item">å¦‚æœä¸ä½¿ç”¨åŒ…è£å™¨çš„è©±ï¼Ÿ</h2><p>è‹¥ä¸ä½¿ç”¨åŒ…è£å™¨ï¼Œåœ¨ Telegram Bot API ä¸­æ‰€æœ‰çš„æ“ä½œï¼Œä¸è«–æ˜¯ <strong>[æ¥æ”¶è³‡è¨Š]</strong> é‚„æ˜¯ <strong>[ç™¼é€è¨Šæ¯]</strong> éƒ½æ˜¯é€é HTTP API ä¾†é€²è¡Œã€‚çµæ§‹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-text">https://api.telegram.org/bot{BOT_TOKEN}/{METHOD_NAME}
</code></pre>
<ul>
<li><code>BOT_TOKEN</code> -&gt; å¾ BotFather å–å¾—çš„ Token String </li>
<li><code>METHOD_NAME</code> -&gt; å°æ‡‰çš„æ–¹æ³•åç¨±ï¼Œå¦‚ï¼šgetMeã€getUpdates</li>
</ul>
<p>æ”¯æ´ GET èˆ‡ POST çš„æ“ä½œï¼Œæ„å‘³è‘—å°æ–¼ç°¡å–®çš„è¨Šæ¯å¯ä»¥ç›´æ¥ä½¿ç”¨ç€è¦½å™¨è¼¸å…¥ Url QueryParamsã€‚</p>
<pre><code class="language-text">https://api.telegram.org/bot{BOT_TOKEN}/{METHOD_NAME}?url={API_URL}
</code></pre>
<p>é‡å°è¤‡é›œçš„æ“ä½œå¯ä»¥é€é POST ä¸¦å¤¾å¸¶æ–¼ Body ä¸­ã€‚æ”¯æ´çš„ Content-Typeï¼š</p>
<ul>
<li><code>application/x-www-form-urlencoded</code></li>
<li><code>application/json (except for uploading files)</code></li>
<li><code>multipart/form-data (use to upload files)</code></li>
</ul>
<p>ä»¥ GetUpdates ç‚ºä¾‹ï¼Œé€éå‘¼å« APIï¼š
<code>https://api.telegram.org/bot{BOT_TOKEN}/getUpdates</code></p>
<p>æœ€å¾Œç²å¾—çš„ responseï¼š</p>
<pre><code class="language-js">{
  &quot;ok&quot;:true,
  &quot;result&quot;:[
    {
      &quot;update_id&quot;:136940592,
      &quot;message&quot;:{
        &quot;message_id&quot;:964,
        &quot;from&quot;:{
          &quot;id&quot;:549919258,
          &quot;is_bot&quot;:false,
          &quot;first_name&quot;:&quot;Ch.&quot;,
          &quot;last_name&quot;:&quot;S&quot;,
          &quot;username&quot;:&quot;Saweima&quot;
        },
        &quot;chat&quot;:{
          &quot;id&quot;:-1001756617092,
          &quot;title&quot;:&quot;T1 Group&quot;,
          &quot;type&quot;:&quot;supergroup&quot;
        },
        &quot;date&quot;:1657095304,
        &quot;text&quot;:&quot;test&quot;
      }
    }
  ]
}
</code></pre>
<p>åœ¨ä¸ä½¿ç”¨åŒ…è£å™¨çš„æƒ…æ³ä¸‹ï¼Œéœ€è¦è‡ªå·±çµ„åˆå‡ºå°æ‡‰çš„ API URL å‘¼å«ï¼Œä¸¦ä¸”è‡ªå·±è™•ç†å›å‚³çš„ messageã€‚ é€™äº›æ˜¯åŒ…è£å™¨ä¸»è¦ç¯€çœçš„éƒ¨ä»½ã€‚</p>
<h2 id="æ³¨æ„äº‹é …" class="heading-item">æ³¨æ„äº‹é …</h2><ul>
<li>éƒ¨ä»½æ©Ÿå™¨äººçš„æ“ä½œï¼ˆå¦‚ï¼šåˆªé™¤å…¶ä»–äººè¨Šæ¯ã€è¨­å®šæ¬Šé™...ç­‰ï¼‰éœ€è¦æœ‰å°æ‡‰çš„ç¾¤çµ„æ¬Šé™ã€‚</li>
<li>éç¾¤çµ„ç®¡ç†å“¡çš„æ©Ÿå™¨äººï¼Œåªåœ¨é‡åˆ°è‡ªå·±ç™»è¨˜éçš„æŒ‡ä»¤æ‰æœƒæ”¶åˆ°ç›¸é—œè¨Šæ¯ã€‚</li>
<li>è‹¥ç‚ºç¾¤çµ„ç®¡ç†å“¡çš„æ©Ÿå™¨äººï¼Œæœƒæ¥æ”¶åˆ°è©²ç¾¤çµ„å…§çš„æ‰€æœ‰è¨Šæ¯ã€‚</li>
<li>è‹¥ä¸€å‰‡è¨Šæ¯åœ¨ Telegram ä¼ºæœå™¨ç™¼é€çµ¦æ©Ÿå™¨äººä¹‹å‰è¢«åˆªé™¤ï¼Œå‰‡æ©Ÿå™¨äººæœƒæ”¶ä¸åˆ°è©²å‰‡è¨Šæ¯ã€‚</li>
<li>Telegram è¶…é 500 äººçš„ç¾¤çµ„æœ‰å¯èƒ½æ”¶ä¸åˆ° Join Messageã€‚</li>
<li>æ©Ÿå™¨äººä¹‹é–“æœƒäº’ç›¸å¹²æ“¾ï¼Œå¿…é ˆç¢ºä¿æ©Ÿå™¨äººç”¢ç”Ÿçš„å°è©±å…§å®¹ã€æ¥æ”¶çš„æŒ‡ä»¤ä¸æœƒè§¸ç™¼å…¶ä»–æ©Ÿå™¨äººã€‚</li>
</ul>
<h2 id="tldr" class="heading-item">TL;DR</h2><ul>
<li>AIOGram æ˜¯ Telegram Bot API çš„åŒ…è£å™¨ï¼Œç”¨ä»¥ç°¡åŒ–æ©Ÿå™¨äººé–‹ç™¼æµç¨‹ã€‚</li>
<li>AIOGram æ”¯æ´<strong>è¼ªè©¢æŠ“å–æ›´æ–° - Polling</strong> åŠ<strong>è¢«å‹•æ¥æ”¶æ›´æ–° - Webhook</strong>ã€‚</li>
<li>æ¨è–¦ä½¿ç”¨ Webhook ä½œç‚ºæ¥æ”¶æ›´æ–°çš„æ–¹å¼ï¼Œç”¨ä»¥ç¯€çœæµé‡èˆ‡é‹ç®—è³‡æºã€‚</li>
<li>ä½¿ç”¨ Webhook æ¥æ”¶æ›´æ–°éœ€è¦æœ‰æ”¯æ´ https çš„ domainã€‚</li>
<li>å¯ä»¥é€é Ngrok çš„åå‘ä»£ç†ï¼Œæ¸¬è©¦æœ¬æ©Ÿç«¯çš„ Webhook èˆ‡ API ã€‚</li>
<li>è‹¥ä¸ä½¿ç”¨åŒ…è£å™¨ï¼Œå‰‡éœ€è¦è‡ªå·±çµ„åˆå‡º HTTP URL åŠè‡ªè¡Œè™•ç†è¨Šæ¯çš„è§£æã€‚</li>
</ul>
<!-- HTML_TAG_END --></article></div></div>

</div></main>
				<footer class="w-full pt-20 pb-5 site-footer svelte-1esoz7b"><div class="flex justify-center items-center px-10 h-full footer-container"><div class="copyright">Copyright Â© 2020 - 2022 Saweicore Lab All Rights Reserved.</div></div>
</footer></div>

			<div class="hidden lg:block drawer-wrapper mr-0.5"><div class="w-full min-h-screen h-full drawer-container"><div class="flex flex-col h-full widget-list"><div class="widget-list-item my-3 svelte-zx3hu4"><div class="w-full cursor-pointer search-widget svelte-q0vdx1"><div class="flex flex-row h-full justify-center items-center label svelte-q0vdx1"><div class="flex self-center mr-2 w-4 label-icon"><svg viewBox="0 0 24 24" aria-hidden="true" class="svelte-1h287kj"><path fill="currentColor" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"></path></svg></div>
        <div class="label-text mr-2">Search</div>
        <div class="flex label-container items-center label-keys"><div class="label-key svelte-q0vdx1">Ctrl</div>
            <div class="label-key svelte-q0vdx1">/</div></div></div>
</div></div>

    <div class="widget-list-item svelte-zx3hu4"><div class="author-widget"><div class="w-32 h-32"><img class="avatar svelte-9pb7ln" src="https://avatars.githubusercontent.com/u/62002212" alt="Saweima" loading="lazy" width="128" height="128"></div>  
    <div class="mt-3 name svelte-9pb7ln"><h2>Saweima</h2></div> 
    <div class="mr-3 letter-content-font description svelte-9pb7ln"><p>é›œé …å·¥ç¨‹å¸« | å¹£åœˆå°ç™½ | æƒ³åˆ°å†å¯«</p></div>
</div></div>
    
    <div class="widget-list-item sticky top-14 svelte-zx3hu4">

<div class="outline-widget svelte-1tqky31"><ul class="overflow-y-auto outline-list svelte-1tqky31"><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#aiogram" class="svelte-1tqky31">AIOGram</a>
            </div><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#è¨»å†Š-telegram-bot" class="svelte-1tqky31">è¨»å†Š Telegram Bot</a>
            </div><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#å»ºç«‹åŸºæœ¬çµæ§‹" class="svelte-1tqky31">å»ºç«‹åŸºæœ¬çµæ§‹</a>
            </div><div class="level-3 py-0.5 outline-item svelte-1tqky31"><a href="#ä½¿ç”¨-polling" class="svelte-1tqky31">ä½¿ç”¨ Polling</a>
            </div><div class="level-3 py-0.5 outline-item svelte-1tqky31"><a href="#ä½¿ç”¨-webhook" class="svelte-1tqky31">ä½¿ç”¨ Webhook</a>
            </div><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#å¦‚ä½•åœ¨æœ¬åœ°ç«¯é€²è¡Œæ¸¬è©¦ï¼Ÿ" class="svelte-1tqky31">å¦‚ä½•åœ¨æœ¬åœ°ç«¯é€²è¡Œæ¸¬è©¦ï¼Ÿ</a>
            </div><div class="level-3 py-0.5 outline-item svelte-1tqky31"><a href="#ngrok" class="svelte-1tqky31">Ngrok</a>
            </div><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#å¦‚æœä¸ä½¿ç”¨åŒ…è£å™¨çš„è©±ï¼Ÿ" class="svelte-1tqky31">å¦‚æœä¸ä½¿ç”¨åŒ…è£å™¨çš„è©±ï¼Ÿ</a>
            </div><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#æ³¨æ„äº‹é …" class="svelte-1tqky31">æ³¨æ„äº‹é …</a>
            </div><div class="level-2 py-0.5 outline-item svelte-1tqky31"><a href="#tldr" class="svelte-1tqky31">TL;DR</a>
            </div></ul>
</div></div>


</div></div></div></div></div></div>

<div class="fixed top-0 z-10 w-screen h-screen screenmask hidden"></div>


<div class="fixed z-30 top-0 left-0 bottom-0 w-60 md:w-80 h-screen transition-all duration-200 navmenu svelte-7saduy -translate-x-full"><div class="flex flex-col h-full navmenu-container"><div class="py-4 mb-2 header"><div class="flex items-center mb-4 pl-8"><div class="title text-lg svelte-7saduy">Saweicore Lab</div>
					<button class="flex text-xl letter-content-font theme-switch svelte-7saduy"><div class="icon-base w-6"><svg viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>ic_fluent_dark_theme_24_filled</title><desc>Created with Sketch.</desc><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g fill="#212121" fill-rule="nonzero"><path fill="currentColor" d="M12,22 C17.5228475,22 22,17.5228475 22,12 C22,6.4771525 17.5228475,2 12,2 C6.4771525,2 2,6.4771525 2,12 C2,17.5228475 6.4771525,22 12,22 Z M12,20 L12,4 C16.418278,4 20,7.581722 20,12 C20,16.418278 16.418278,20 12,20 Z" id="ğŸ¨-Color"></path></g></g></svg></div></button></div>

			<div class="flex flex-row mx-6 author-block svelte-7saduy"><img src="https://avatars.githubusercontent.com/u/62002212" alt="saweima" loading="lazy" width="80" height="80" class="svelte-7saduy">
				<div class="flex flex-col word-font items-center justify-center ml-4 avatar-info"><div class="font-bold text-lg">Saweima</div>
					<div>é‚Šç·£å·¥ä½œè€…</div></div></div></div>
		<ul class="nav-list">
			<li class="flex nav-item svelte-7saduy"><a sveltekit:prefetch href="/journal" alt="" class="w-full h-full"><div class="flex items-center pl-8 mt-1 mb-4 nav-item-content"><div class="icon-base w-6"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" fill-rule="evenodd" d="M19,2 C20.6568542,2 22,3.34314575 22,5 L22,19 C22,20.6568542 20.6568542,22 19,22 L5,22 C3.34314575,22 2,20.6568542 2,19 L2,5 C2,3.34314575 3.34314575,2 5,2 L19,2 Z M20,8 L4,8 L4,19 C4,19.5522847 4.44771525,20 5,20 L19,20 C19.5522847,20 20,19.5522847 20,19 L20,8 Z M12.1167504,17.9932723 L12.0000776,18 L11.916,17.996 L11.7993725,17.9797599 L11.7993725,17.9797599 L11.6879528,17.9502619 L11.6879528,17.9502619 L11.5768709,17.9063266 L11.5768709,17.9063266 L11.4793812,17.8540045 L11.4793812,17.8540045 L11.4049183,17.8036865 L11.4049183,17.8036865 L11.2929784,17.7071068 L8.29290079,14.7071068 C7.9023664,14.3165825 7.9023664,13.6834175 8.29290079,13.2928932 C8.65339407,12.9324093 9.22063979,12.9046797 9.61294114,13.2097046 L9.70715092,13.2928932 L11,14.585 L11.0000776,11 C11.0000776,10.4871642 11.3861178,10.0644928 11.8834564,10.0067277 L12.0001293,10 C12.552414,10 13.0001293,10.4477153 13.0001293,11 L13,14.585 L14.2930559,13.2928932 C14.6535492,12.9324093 15.2207949,12.9046797 15.6130963,13.2097046 L15.707306,13.2928932 C16.0677993,13.6533772 16.0955296,14.2206082 15.7904968,14.6128994 L15.707306,14.7071068 L12.7072361,17.7071068 L12.6217218,17.7833908 L12.6217218,17.7833908 L12.5518984,17.8341416 L12.5518984,17.8341416 L12.4539624,17.8913373 L12.4539624,17.8913373 L12.3401306,17.9407132 L12.3401306,17.9407132 L12.2661033,17.9641549 L12.1167504,17.9932723 L12.1167504,17.9932723 Z M19,4 L5,4 C4.44771525,4 4,4.44771525 4,5 L4,6 L20,6 L20,5 C20,4.44771525 19.5522847,4 19,4 Z"></path></svg></div>
					<div class="pl-4 text-xl letter-content-font">Journal</div>
					</div>
				</a>
			</li>
			<li class="flex nav-item svelte-7saduy"><a sveltekit:prefetch href="/about" alt="" class="w-full h-full"><div class="flex items-center pl-8 mt-1 mb-4 nav-item-content"><div class="icon-base w-6"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" xmlns:xlink="http://www.w3.org/1999/xlink" enable-background="new 0 0 512 512"><g><g><path fill="currentColor" d="m480.6,11c-40.6,0-80.2,12.7-118.6,25-36.9,11.9-71.8,23.1-106,23.1-34.2,0-69.1-11.2-106-23.1-38.3-12.3-78-25-118.6-25-11.3,0-20.4,9.1-20.4,20.4v401c0,11.3 9.1,20.4 20.4,20.4 34.2,0 69.1,11.2 106,23.1 38.3,12.3 77.9,25 118.5,25 40.6,0 80.2-12.7 118.5-25 36.9-11.9 71.8-23.1 106-23.1 11.3,0 20.4-9.1 20.4-20.4v-401c0.2-11.3-8.9-20.4-20.2-20.4zm-428.8,402.1v-360c27.7,3.2 56,12.3 85.6,21.9 31.9,10.2 64.6,20.8 98.1,24v360c-27.7-3.2-56-12.3-85.6-21.8-31.8-10.4-64.6-20.9-98.1-24.1zm408.4,0c-33.5,3.3-66.3,13.8-98.1,24-29.6,9.5-57.9,18.6-85.6,21.8v-360c33.5-3.3 66.3-13.8 98.1-24 29.6-9.5 57.9-18.6 85.6-21.9v360.1z"></path><path fill="currentColor" d="m183.6,144l-68.1-20.4c-10.8-3.2-22.2,2.9-25.4,13.7-3.2,10.8 2.9,22.2 13.7,25.4 0,0 72,21.3 73.9,21.3 8.8,0 16.9-5.7 19.5-14.6 3.3-10.7-2.8-22.1-13.6-25.4z"></path><path fill="currentColor" d="m183.6,246.6l-68.1-20.4c-10.8-3.2-22.2,2.9-25.4,13.7-3.2,10.8 2.9,22.2 13.7,25.4 0,0 72,21.3 73.9,21.3 8.8,0 16.9-5.7 19.5-14.6 3.3-10.7-2.8-22.1-13.6-25.4z"></path><path fill="currentColor" d="m183.6,349.3l-68.1-20.4c-10.8-3.2-22.2,2.9-25.4,13.7-3.2,10.8 2.9,22.2 13.7,25.4 0,0 72,21.3 73.9,21.3 8.8,0 16.9-5.7 19.5-14.6 3.3-10.8-2.8-22.2-13.6-25.4z"></path><path fill="currentColor" d="m314.7,169.4c2.7,8.9 10.8,14.6 19.5,14.6 1.9,0 73.9-21.3 73.9-21.3 10.8-3.2 16.9-14.6 13.7-25.4-3.3-10.8-14.6-16.9-25.4-13.7l-68,20.4c-10.8,3.3-16.9,14.7-13.7,25.4z"></path><path fill="currentColor" d="m396.5,226.2l-68.1,20.4c-10.8,3.2-16.9,14.6-13.7,25.4 2.7,8.9 10.8,14.6 19.5,14.6 1.9,0 73.9-21.3 73.9-21.3 10.8-3.2 16.9-14.6 13.7-25.4-3.2-10.8-14.5-16.8-25.3-13.7z"></path><path fill="currentColor" d="m396.5,328.9l-68.1,20.4c-10.8,3.2-16.9,14.6-13.7,25.4 2.7,8.9 10.8,14.6 19.5,14.6 1.9,0 73.9-21.3 73.9-21.3 10.8-3.2 16.9-14.6 13.7-25.4-3.2-10.8-14.5-16.9-25.3-13.7z"></path></g></g></svg></div>
					<div class="pl-4 text-xl letter-content-font">About</div>
					</div>
				</a>
			</li>
			<li class="flex nav-item svelte-7saduy"><a href="http://github.com/saweima12" alt="" class="w-full h-full"><div class="flex items-center pl-8 mt-1 mb-4 nav-item-content"><div class="icon-base w-6"><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" class="icon"><path fill="currentColor" d="m256 0c-140.609375 0-256 115.390625-256 256 0 119.988281 84.195312 228.984375 196 256v-84.695312c-11.078125 2.425781-21.273438 2.496093-32.550781-.828126-15.128907-4.464843-27.421875-14.542968-36.546875-29.910156-5.816406-9.8125-16.125-20.453125-26.878906-19.671875l-2.636719-29.882812c23.253906-1.992188 43.371093 14.167969 55.3125 34.230469 5.304687 8.921874 11.410156 14.152343 19.246093 16.464843 7.574219 2.230469 15.707032 1.160157 25.183594-2.1875 2.378906-18.972656 11.070313-26.074219 17.636719-36.074219v-.015624c-66.679687-9.945313-93.253906-45.320313-103.800781-73.242188-13.976563-37.074219-6.476563-83.390625 18.238281-112.660156.480469-.570313 1.347656-2.0625 1.011719-3.105469-11.332032-34.230469 2.476562-62.546875 2.984375-65.550781 13.078125 3.867187 15.203125-3.890625 56.808593 21.386718l7.191407 4.320313c3.007812 1.792969 2.0625.769531 5.070312.542969 17.371094-4.71875 35.683594-7.324219 53.726563-7.558594 18.179687.234375 36.375 2.839844 54.464844 7.75l2.328124.234375c-.203124-.03125.632813-.148437 2.035157-.984375 51.972656-31.480469 50.105469-21.191406 64.042969-25.722656.503906 3.007812 14.128906 31.785156 2.917968 65.582031-1.511718 4.65625 45.058594 47.300781 19.246094 115.753906-10.546875 27.933594-37.117188 63.308594-103.796875 73.253907v.015624c8.546875 13.027344 18.816406 19.957032 18.761719 46.832032v105.722656c111.808594-27.015625 196-136.011719 196-256 .003906-140.609375-115.386719-256-255.996094-256zm0 0"></path></svg></div>
					<div class="pl-4 text-xl letter-content-font">Github</div>
					<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div>
				</a>
			</li></ul>
		<div class="grow spacer"></div></div>
</div>


<div class="search-box svelte-fha6x8 hidden"><div class="search-bar svelte-fha6x8"><form class="flex items-center p-5 h-full" autocomplete="off" role="search"><div class="icon-base w-8 mr-4"><svg viewBox="0 0 24 24" aria-hidden="true" class="svelte-1h287kj"><path fill="currentColor" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"></path></svg></div>
            <input id="search-input" type="text" autocomplete="off" class="h-full w-full svelte-fha6x8"></form></div>
    <div class="typehead-wrapper"><div class="typehead-container">
</div></div>
</div>
<div class="lightbox-wrapper svelte-1b9dfdw translate-x-full opacity-0"><div class="flex items-center h-full lightbox-container svelte-1b9dfdw"></div>
</div>




		<script type="module" data-sveltekit-hydrate="c7hdr2">
		import { set_public_env, start } from "../../../_app/immutable/start-34fd70cd.js";

		set_public_env({});

		start({
			target: document.querySelector('[data-sveltekit-hydrate="c7hdr2"]').parentNode,
			paths: {"base":"","assets":""},
			route: true,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				node_ids: [0, 7],
				params: {year:"2022",month:"07",slug:"create-aiogram-project"},
				routeId: "posts/[year]/[month]/[slug]"
			}
		});
	</script>
	<script type="application/json" sveltekit:data-type="data" sveltekit:data-url="/api/config.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"{\"title\":\"Saweicore Lab\",\"summary\":\"ç¨‹å¼é–‹ç™¼ | ç¶²ç«™æ¶è¨­ | å¹£åœˆé›œè«‡ | å„é …é›œç‡´é›†æ•£åœ°\",\"description\":\"SaweiCore Lab æ˜¯ç”¨æ–¼è¨˜éŒ„èˆ‡æ­¸æª”å€‹äººçš„ç ”ç©¶å¿ƒå¾—çš„é›†æ•£åœ°ï¼Œå…§å®¹å¤šä»¥ç¶²ç«™æ¶è¨­ã€ç¨‹å¼é–‹ç™¼ã€å¹£åœˆæ¢ç´¢ç‚ºä¸»ä¸¦ä»¥éœ€æ±‚å°å‘æ¢è¨å•é¡Œä¸¦è¨˜éŒ„å°æ‡‰çš„è§£æ±ºæ–¹æ¡ˆï¼Œä»¥ä¾¿å¾ŒçºŒæŸ¥é–±ã€‚\",\"url\":\"https://saweicore.com\",\"ga\":\"G-KY269QECHX\",\"author\":{\"name\":\"Saweima\",\"email\":\"saweima12@gmail.com\",\"summary\":\"é‚Šç·£å·¥ä½œè€…\",\"description\":\"é›œé …å·¥ç¨‹å¸« | å¹£åœˆå°ç™½ | æƒ³åˆ°å†å¯«\",\"avatar\":\"https://avatars.githubusercontent.com/u/62002212\"},\"pagination\":{\"maxPerPage\":8},\"classifier\":[{\"id\":\"post\",\"params\":{\"path\":\"/_posts/\"},\"type\":\"directory\"},{\"id\":\"tag\",\"params\":{\"keys\":[\"tag\",\"tags\"]},\"type\":\"frontmatter\"}],\"marked\":{\"options\":{},\"extensions\":[{\"renderer\":{}},{\"renderer\":{}}]},\"search\":{\"appKey\":\"BHODY4NQKK\",\"apiKey\":\"5f4c05344cf6d1cbe581c20e049a7c14\",\"index\":\"SaweicoreLab\"},\"nav\":[{\"id\":\"journal\",\"name\":\"Journal\",\"link\":\"/journal\"},{\"id\":\"about\",\"name\":\"About\",\"link\":\"/about\"},{\"id\":\"github\",\"name\":\"Github\",\"link\":\"http://github.com/saweima12\"}]}"}</script>
	<script type="application/json" sveltekit:data-type="data" sveltekit:data-url="/api/posts/2022/07/create-aiogram-project.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"{\"metadata\":{\"title\":\"ç”¨ AIOGram å»ºç«‹æ©Ÿå™¨äººå°ˆæ¡ˆ â€” Telegram Bot é–‹ç™¼é›œè«‡ï¼ˆä¸€ï¼‰\",\"tags\":[\"bot\",\"python\",\"programing\"],\"excerpt\":\"å»£å‘Šæ©Ÿå™¨äººä¸€å¤§å †ã€é¬§ç¾¤ä»½å­ä¸€å€‹æ¥ä¸€å€‹ï¼Ÿåˆæˆ–æ˜¯æƒ³è¦åšäº›èŠå¤©æ©Ÿå™¨äººå°å·¥å…·ï¼Ÿé€é AIOGram å¿«é€Ÿé–‹ç™¼ Python Telegram Botï¼Œç”¨æµç¨‹è‡ªå‹•åŒ–è§£æ±ºæ‰€æœ‰éº»ç…©äº‹æƒ…ã€‚\",\"created\":\"2022-07-23T00:00:00.000Z\"},\"content\":\"\u003Cp>åˆå®‰æ—…äººï¼Œé€™è£¡æ˜¯ä¸€å€‹æœˆæ²’æœ‰æ›´æ–°æ–‡ç« çš„ Saweimaã€‚ä¸çŸ¥é“æ—…äººæœ‰æ²’æœ‰åœ¨ Telegram å…¬é–‹ç¾¤çµ„é‡åˆ°éæƒ¡æ„é¨·æ“¾äººå£«å‘¢ï¼Ÿæ™‚ä¸æ™‚çš„é–‹æ–°å¸³è™Ÿè·‘é€²ç¾¤çµ„è²¼ä¸€äº›æœƒè®“äººæ„Ÿåˆ°å™å¿ƒçš„åœ–ç‰‡ï¼Œè¸¢å®Œéä¸€é™£å­åˆå†æ¬¡æ•…æŠ€é‡æ–½ï¼ŒçŒ¶å¦‚èŸ‘è‚ä¸€èˆ¬ï¼Œæ®ºä¹Ÿæ®ºä¸å®Œã€‚\u003C/p>\\n\u003Cp>è€ƒé‡åˆ°ç®¡ç†å“¡ä¸å¯èƒ½æ™‚æ™‚åˆ»åˆ»éƒ½åœ¨ã€åˆªé™¤åœ–ç‰‡æ™‚ç®¡ç†å“¡è‡ªèº«ä¹Ÿä¸å¯é¿å…çš„æœƒå—åˆ°ç²¾ç¥æ”»æ“Šï¼Œäººå·¥è™•ç†é¡¯ç„¶ä¸æ˜¯ä¸€ç¨®å¥½è¾¦æ³•ã€‚ç”±æ–¼éœ€æ±‚çš„æ€¥è¿«æ€§ï¼ŒèŠ±äº†å¹¾é€±æ™‚é–“ç ”ç©¶åŠç·¨å¯«æ©Ÿå™¨äººï¼Œåœ¨é€™é‚Šè¨˜éŒ„ä¸‹è‡ªå·±ç”¨åˆ°çš„æ±è¥¿å€‘ã€‚\u003C/p>\\n\u003Ch2 id=\\\"aiogram\\\" class=\\\"heading-item\\\">AIOGram\u003C/h2>\u003Cp>AIOGram æ˜¯ Telegram Bot API çš„ Python åŒ…è£å™¨ï¼Œç”¨æ–¼å°‡ç¹ç‘£çš„ HTTP API å‘¼å«æµç¨‹åŒ…è£ç‚ºç¨‹å¼ç‰©ä»¶ä¸¦è§£æ API çš„å›å‚³è³‡æ–™ï¼Œè®“æ“ä½œæµç¨‹èˆ‡ç¨‹å¼èªå¥ä¸€æ¨£ç›´è§€ã€‚\u003C/p>\\n\u003Cblockquote>\\n\u003Cp>\u003Cstrong>AIOGram\u003C/strong> \u003Cbr/>\\nGithub: \u003Ca href=\\\"https://github.com/aiogram/aiogram\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopenner\\\">é»æˆ‘é€²å…¥\u003C/a> \u003Cbr/>\\nå®˜æ–¹æ–‡æ“‹: \u003Ca href=\\\"https://docs.aiogram.dev/en/latest/\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopenner\\\">é»æˆ‘é€²å…¥\u003C/a> \u003Cbr/>\u003C/p>\\n\u003C/blockquote>\\n\u003Cp>ç‰¹æ€§ï¼š\u003C/p>\\n\u003Cul>\\n\u003Cli>ä½¿ç”¨ Python 3.7 ä»¥ä¸Šç‰ˆæœ¬ã€‚\u003C/li>\\n\u003Cli>é€é asyncio åŠ aiphttp å¯¦ä½œï¼Œæ”¯æ´ Asynchronous ï¼ˆç•°æ­¥/éåŒæ­¥ï¼‰èª¿ç”¨ã€‚\u003C/li>\\n\u003Cli>å…§ç½® API å°åŒ…è§£æåŠå®šç¾©å‹åˆ¥ï¼Œçœå»ç ”ç©¶å°åŒ…çµæ§‹çš„æ™‚é–“ã€‚\u003C/li>\\n\u003C/ul>\\n\u003Cp>å…¶ä»–çš„ API åŒ…è£å™¨å¯åƒè€ƒ \u003Ca href=\\\"https://core.telegram.org/bots/samples\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopenner\\\">\u003Cstrong>Telegram çš„å®˜æ–¹åˆ—è¡¨\u003C/strong>\u003C/a>\u003C/p>\\n\u003Ch2 id=\\\"è¨»å†Š-telegram-bot\\\" class=\\\"heading-item\\\">è¨»å†Š Telegram Bot\u003C/h2>\u003Cp>åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œå¿…é ˆå…ˆé€é Telegram Bot Father è¨»å†Šæ–°çš„ bot å¸³æˆ¶ã€‚\u003C/p>\\n\u003Cimg class=\\\"lightbox\\\" src=\\\"https://media.saweicore.com/blog/create-aiogram-project/register-tg-bot.jpg\\\" height=\\\"500\\\" />\\n\\n\\n\u003Cul>\\n\u003Cli>åŠ å…¥æœ‰è—è‰²å‹¾å‹¾ï¼ˆè­‰æ˜ç‚ºå®˜æ–¹å¸³è™Ÿï¼‰çš„ BotFather\u003C/li>\\n\u003Cli>è¼¸å…¥æŒ‡ä»¤ \u003Ccode>/newbot\u003C/code> è¨»å†Šæ–°çš„ Bot\u003C/li>\\n\u003Cli>ç¬¬ä¸€æ¬¡è¼¸å…¥ Bot çš„åç¨±\u003C/li>\\n\u003Cli>ç¬¬äºŒæ¬¡è¼¸å…¥ Bot çš„å¸³è™Ÿ\u003C/li>\\n\u003C/ul>\\n\u003Cp>ä»¥ä¸Šæµç¨‹éƒ½æˆåŠŸå¾Œå°±å¾Œæœƒå–å¾—ä½¿ç”¨ API çš„ TOKEN å¦‚ï¼š\u003Ccode>5292723007:AAE-APVbUkZgOZ6CVb4GM_KfV7CtE5dgLmw\u003C/code>ï¼Œé€™æ®µéœ€è¦ä¿å­˜å¥½ï¼Œæœªä¾†æ‰€æœ‰æ“ä½œéƒ½æœƒéœ€è¦ç”¨åˆ°ã€‚\u003C/p>\\n\u003Ch2 id=\\\"å»ºç«‹åŸºæœ¬çµæ§‹\\\" class=\\\"heading-item\\\">å»ºç«‹åŸºæœ¬çµæ§‹\u003C/h2>\u003Cp>AIOGram å„ Module è² è²¬çš„åŠŸèƒ½ï¼š\u003C/p>\\n\u003Cul>\\n\u003Cli>\u003Ccode>Bot\u003C/code> class å°‡æ‰€æœ‰ Telegram Bot API çš„æŒ‡ä»¤åŒ…è£æˆ function å½¢å¼ï¼Œä¸»è¦è² è²¬å‚³é€ request çµ¦ Telegram ä¼ºæœå™¨ã€‚\u003C/li>\\n\u003Cli>\u003Ccode>Dispatcher\u003C/code> class è² è²¬æ¥æ”¶æ‰€æœ‰é€é Webhook æ”¶åˆ°çš„è¨Šæ¯ï¼Œä¸¦è½‰æ›ç‚ºå°æ‡‰çš„ Objectã€‚\u003C/li>\\n\u003Cli>\u003Ccode>types\u003C/code> module åº•ä¸‹åŒ…å«æ‰€æœ‰å‹åˆ¥åŠå…¶ç›¸é—œçš„è¼”åŠ© Functionï¼Œå¦‚ Updateã€Messageã€‚\u003C/li>\\n\u003C/ul>\\n\u003Cp>é‹è¡Œçš„ä¸»è¦æµç¨‹ï¼š\\n-&gt; æ¥æ”¶ Telegram çš„ Update è¨Šæ¯\\n-&gt; å‚³å…¥ Dispatcher é€²è¡Œåˆ†é¡\\n-&gt; Dispatcher å°‡åˆ†é¡å¾Œçš„è¨Šæ¯ç™¼é€çµ¦è¨»å†Šçš„ Handler \\n-&gt; Handler é€²è¡Œè™•ç†å¾Œå›å‚³ HTTP Response çµ¦ Telegram ä¼ºæœå™¨ï¼ˆå¦‚æœæ”¶åˆ°é 200 çš„ status code æœƒç­‰å¾…ä¸€å®šæ™‚é–“å¾Œé‡æ–°å‚³é€ï¼‰\u003C/p>\\n\u003Cp>\u003Cstrong>Update è³‡è¨Šçš„å–å¾—æ–¹å¼æœ‰ä»¥ä¸‹å…©ç¨®ï¼š\u003C/strong>\u003C/p>\\n\u003Ch3 id=\\\"ä½¿ç”¨-polling\\\" class=\\\"heading-item\\\">ä½¿ç”¨ Polling\u003C/h3>\u003Cpre>\u003Ccode class=\\\"language-py\\\"># å°å…¥ Aiogram åŒ…\\nfrom aiogram import Bot\\nfrom aiogram.types import Message, ContentTypes\\nfrom aiogram.dispatcher import Dispatcher\\nfrom aiogram.utils.executor import start_polling\\n\\n# è¨˜éŒ„ BOT_TOKEN ä¸¦ä¸”å»ºç«‹ Bot ç‰©ä»¶\\nBOT_TOKEN = &quot;5292723007:AAE-APVbUkZgOZ6CBGM_KfV7CtE5dgLmw&quot;\\nbot = Bot(BOT_TOKEN)\\n# å»ºç«‹ Bot çš„åˆ†ç™¼å™¨ï¼ˆæ”¶åˆ°çš„ Data æœƒè¢«å‚³å…¥é€™è£¡\\ndp = Dispatcher(bot)\\n\\n# Process start command\\n@dp.message_handler(commands=[&#39;start&#39;])\\nasync def on_start_command(message: Message):  \\n    print(&quot;on start command&quot;)\\n\\n# Process all messages except start command\\n@dp.message_handler(content_types=ContentTypes.ANY)\\nasync def on_message(message: Message):\\n    await message.reply(message.from_user.id)\\n\\nasync def on_startup(dispatcher: Dispatcher):\\n    print(&quot;startup&quot;)\\n\\nasync def on_shutdown(dispatcher: Dispatcher):\\n    print(&quot;shutdown&quot;)\\n\\n\\nif __name__ == &quot;__main__&quot;:\\n    start_polling(dp, on_startup=on_startup, on_shutdown=on_shutdown)\\n\u003C/code>\u003C/pre>\\n\u003Cp>Polling æ–¹å¼æ˜¯é€éä¸€å€‹è¿´åœˆï¼Œå®šæœŸçš„å‘¼å« Telegram Bot API çš„ getUpdate æ–¹æ³•å–å¾—æ–°çš„è¨Šæ¯ï¼Œä¸¦å°‡å…¶å‚³å…¥ dispatcher é€²è¡Œåˆ†ç™¼ï¼Œç›´åˆ°è¢«ä¸­æ–·ç‚ºæ­¢ã€‚\u003C/p>\\n\u003Cul>\\n\u003Cli>\u003Ccode>Bot\u003C/code> é¡è² è²¬èˆ‡ Bot API æºé€šï¼ŒåŒ…å« \u003Cstrong>send_message\u003C/strong> æˆ– \u003Cstrong>deleted_message\u003C/strong> ç­‰ä¸»å‹•æ“ä½œçš„ method ã€‚\u003C/li>\\n\u003Cli>\u003Ccode>Dispatcher\u003C/code> é¡è² è²¬\u003Cstrong>æ¥æ”¶ API çš„ Update è¨Šæ¯\u003C/strong>ï¼ˆä¸è«–æ˜¯é€é Polling é‚„æ˜¯ Webhook æ¥æ”¶çš„ï¼‰ä¾æ“šç‰¹å¾µåˆ†ç™¼çµ¦å„ message_handler ã€‚\u003C/li>\\n\u003Cli>\u003Ccode>Message\u003C/code> é¡æ˜¯\u003Cstrong>é€é Dispatcher åˆ†é¡éå¾Œçš„è¨Šæ¯ç‰©ä»¶\u003C/strong>ï¼ŒåŒ…å« message_id , chat_id, user_id ç­‰é—œéµçš„åˆ¤æ–·è¨Šæ¯ï¼Œ AIOGram ä¹Ÿæœ‰åœ¨æ­¤åŸºç¤ä¸Šå¯¦ä½œè¨±å¤šè¼”åŠ©æ–¹æ³•ã€‚\u003C/li>\\n\u003Cli>\u003Ccode>dp.message_handler()\u003C/code> å¯ä»¥\u003Cstrong>å°‡åº•ä¸‹çš„ function è¨»å†Šç‚ºè™•ç†å™¨\u003C/strong>ï¼Œä¸¦ä¸”é€éåƒæ•¸å¦‚: \u003Cstrong>content_types\u003C/strong> ã€\u003Cstrong>commands\u003C/strong> è¨­å®šåªæ¥åŒ…å«å“ªäº›ç‰¹å¾µçš„è¨Šæ¯ã€‚\u003C/li>\\n\u003Cli>\u003Ccode>start_polling\u003C/code> ç”¨æ–¼åŸ·è¡Œ\u003Cstrong>è¼ªè©¢æŠ“å– Telegram çš„è¨Šæ¯\u003C/strong>æ›´æ–°ã€‚\u003C/li>\\n\u003C/ul>\\n\u003Ch3 id=\\\"ä½¿ç”¨-webhook\\\" class=\\\"heading-item\\\">ä½¿ç”¨ Webhook\u003C/h3>\u003Cpre>\u003Ccode class=\\\"language-py\\\">from aiogram import Bot\\nfrom aiogram.types import Message, ContentTypes\\nfrom aiogram.dispatcher import Dispatcher\\nfrom aiogram.utils.executor import start_webhook\\n\\nBOT_TOKEN = &quot;5292723007:AAE-APVbUkZgOZ6CBGM_KfV7CtE5dgLmw&quot;\\n\\n# WEBHOOK SETTING\\nWEBHOOK_DOMAIN = &quot;https://68dc-211-23-21-139.jp.ngrok.io&quot;\\nWEBHOOK_PATH=&quot;/api&quot;\\nWEBHOOK_URI=f&quot;{WEBHOOK_DOMAIN}{WEBHOOK_PATH}&quot;\\n\\n# WEBHOST SETTING\\nWEB_HOST = &quot;0.0.0.0&quot; # or ip\\nWEB_HOST_PORT = 8000\\n\\nbot = Bot(BOT_TOKEN)\\ndp = Dispatcher(bot)\\n\\n# Process start command\\n@dp.message_handler(commands=[&#39;start&#39;])\\nasync def on_start_command():  \\n    print(&quot;on start command&quot;)\\n\\n# Process all messages except start command\\n@dp.message_handler(content_types=ContentTypes.ANY)\\nasync def on_message(message: Message):\\n    await message.reply(message.from_user.id)\\n\\n\\nasync def on_startup(dispatcher: Dispatcher):\\n    print(&quot;startup&quot;)\\n    await bot.set_webhook(WEBHOOK_URI)\\n\\n\\nasync def on_shutdown(dispatcher: Dispatcher):\\n    print(&quot;shutdown&quot;)\\n    await bot.delete_webhook()\\n\\n\\nif __name__ == &quot;__main__&quot;:\\n    start_webhook(dispatcher=dp, \\n                webhook_path=WEBHOOK_PATH,\\n                on_startup=on_startup,\\n                on_shutdown=on_shutdown,\\n                skip_updates=True,\\n                host=WEB_HOST, \\n                port=WEB_HOST_PORT)\\n\u003C/code>\u003C/pre>\\n\u003Cp>Webhook æ–¹å¼æ˜¯åœ¨å•Ÿå‹•æ™‚é€šçŸ¥ Telegram ä¼ºæœå™¨å°‡æ–°è¨Šæ¯å‚³è¼¸è‡³å°æ‡‰çš„ URLï¼Œé€é HTTP æ¥å£ä¾†æ¥æ”¶è³‡è¨Šã€‚\u003C/p>\\n\u003Cp>å¤§å¤šæ•¸çµæ§‹èˆ‡ä½¿ç”¨ Polling æ™‚ç›¸åŒï¼Œå› æ­¤é€™é‚Šåƒ…åˆ—èˆ‰å·®ç•°çš„åœ°æ–¹ã€‚\u003C/p>\\n\u003Cul>\\n\u003Cli>\u003Ccode>bot.set_webook\u003C/code> ç”¨æ–¼é€šçŸ¥ Telegram ä¼ºæœå™¨ï¼Œå°‡è¨Šæ¯å‚³è¼¸åˆ°è¨»å†Šçš„ URLã€‚\u003C/li>\\n\u003Cli>\u003Ccode>bot.delete_webhook\u003C/code> ç”¨æ–¼é—œé–‰æ™‚é€šçŸ¥ Telegram ä¼ºæœå™¨åœæ­¢è¼¸é€è¨Šæ¯è‡³è¨»å†Šçš„ URL\u003C/li>\\n\u003Cli>\u003Ccode>start_webhook\u003C/code> ç”¨æ–¼å•Ÿå‹• AIOGram å…§å»ºçš„å°å‹ HTTP Server ç›£è½ webhook_path åƒæ•¸æŒ‡å®šçš„è·¯å¾‘ã€‚hostã€port ç”¨æ–¼é…ç½®å•Ÿå‹•çš„ host èˆ‡ portã€‚\u003C/li>\\n\u003C/ul>\\n\u003Cblockquote>\\n\u003Cul>\\n\u003Cli>è¼ƒç‚ºæ¨è–¦ä½¿ç”¨ Webhook æ–¹å¼æ¥æ”¶ Update è¨Šæ¯ï¼Œå¯ä»¥ç¯€çœé »ç¹ç™¼é€å°åŒ…çš„æµé‡åŠä¸æ–·è¼ªè©¢è¨ˆç®—æè€—çš„é›»è…¦è³‡æºã€‚\u003C/li>\\n\u003Cli>ä¸éè¦ä»¥æ­¤ä½œç‚ºæ¥æ”¶è¨Šæ¯æ–¹å¼ï¼Œéœ€è¦ä¸€å€‹æ”¯æ´ HTTPS çš„ç¶²åŸŸã€‚å› æ­¤é‚„æ˜¯ä¾æ“šæ‰‹é‚Šçš„è³‡æºæ±ºå®šã€‚\u003C/li>\\n\u003C/ul>\\n\u003C/blockquote>\\n\u003Ch2 id=\\\"å¦‚ä½•åœ¨æœ¬åœ°ç«¯é€²è¡Œæ¸¬è©¦ï¼Ÿ\\\" class=\\\"heading-item\\\">å¦‚ä½•åœ¨æœ¬åœ°ç«¯é€²è¡Œæ¸¬è©¦ï¼Ÿ\u003C/h2>\u003Cp>å¦‚æœä½¿ç”¨ Polling æ¥æ”¶è³‡è¨Šçš„è©±å€’é‚„å¥½ï¼Œä½†ä½¿ç”¨ Webhook çš„è©±ï¼Œæœ€å…ˆé‡ä¸Šçš„å•é¡Œå°±æ˜¯æ€éº¼é€²è¡Œæ¸¬è©¦ï¼Œç¸½ä¸èƒ½æ¯æ¬¡éƒ½å…ˆç™¼å¸ƒåˆ°é ç«¯ä¼ºæœå™¨ï¼Œåˆæˆ–æ˜¯å…ˆæ”¹æˆ Polling è¦ç™¼å¸ƒæ™‚æ‰æ”¹å›ä¾†ï¼Œå¾ˆæ²’æœ‰æ•ˆç‡ï¼Œé€™æ™‚å€™å°±å¯ä»¥è€ƒæ…®ä½¿ç”¨åå‘ä»£ç†å·¥å…·ã€‚\u003C/p>\\n\u003Ch3 id=\\\"ngrok\\\" class=\\\"heading-item\\\">Ngrok\u003C/h3>\u003Cblockquote>\\n\u003Cp>\u003Cstrong>Ngrok\u003C/strong> \u003Cbr/>\\n\u003Ca href=\\\"https://ngrok.com/\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopenner\\\">https://ngrok.com/\u003C/a>\u003C/p>\\n\u003C/blockquote>\\n\u003Cp>Ngrok æ˜¯ä¸€æ¬¾æœ‰æä¾›å…è²»æ–¹æ¡ˆçš„åå‘ä»£ç†å·¥å…·ï¼Œä¸¦ä¸”æ”¯æ´ HTTPS è½‰ç™¼ï¼Œå¯ä»¥ç”¨æ–¼æœ¬åœ°ç«¯çš„ Webhook æ¸¬è©¦ï¼Œå®Œå…¨æ»¿è¶³é€™æ¬¡çš„éœ€æ±‚ï¼Œä½¿ç”¨å‰éœ€è¦å…ˆåœ¨å®˜ç¶²è¨»å†Šå¸³è™Ÿå–å¾— AUTH_TOKEN ä¸¦ä¸‹è¼‰å°æ‡‰ä½œæ¥­ç³»çµ±çš„æª”æ¡ˆã€‚è¼¸å…¥ä»¥ä¸‹æŒ‡ä»¤è¨­å®š AUTH_TOKEN\u003C/p>\\n\u003Cpre>\u003Ccode class=\\\"language-sh\\\">ngrok config add-authtoken {AUTH_TOKEN}\\n\u003C/code>\u003C/pre>\\n\u003Cp>è¨­å®šå®Œæˆå¾Œï¼Œå†ä¾†åªéœ€è¦è¼¸å…¥ä»¥ä¸‹æŒ‡ä»¤å³å¯å°‡è‡ªå·±çš„ PORT 8000 ç¶å®šåˆ° ngrok æä¾›çš„ domain ä¸Šã€‚\u003C/p>\\n\u003Cpre>\u003Ccode class=\\\"language-sh\\\">ngrok http 8000\\n\u003C/code>\u003C/pre>\\n\u003Cp>æˆåŠŸå¾Œå¦‚ä¸‹ï¼š\u003C/p>\\n\u003Cimg class=\\\"lightbox\\\" src=\\\"https://media.saweicore.com/blog/create-aiogram-project/ngrok-test.jpg\\\" height=\\\"195\\\"/>\\n\\n\u003Cp>åœ–ä¸­çš„ \u003Ccode>https://928c-211-23-21-139.ngrok.io\u003C/code> å°±æ˜¯é€é ngrok å–å¾—çš„ URL DOMAINï¼Œå®ƒå°±ç›¸ç•¶æ–¼é€£æ¥åˆ°æœ¬æ©Ÿçš„ port 8000 ã€‚\u003C/p>\\n\u003Cp>ç•¶ä¸€åˆ‡å°±ç·’ï¼Œå°±å¯ä»¥è©¦è‘—èˆ‡æ©Ÿå™¨äººå°è©±ï¼Œå¦‚æœæŒ‰ç…§ä¸Šé¢çš„ç¯„ä¾‹ï¼Œæ—…äººæ‡‰è©²æœƒæ”¶åˆ°ä¸€ä¸²ç¥å¥‡çš„æ•¸å­—ï¼Œé‚£ä¾¿æ˜¯è‡ªå·±çš„ user_id ã€‚\u003C/p>\\n\u003Ch2 id=\\\"å¦‚æœä¸ä½¿ç”¨åŒ…è£å™¨çš„è©±ï¼Ÿ\\\" class=\\\"heading-item\\\">å¦‚æœä¸ä½¿ç”¨åŒ…è£å™¨çš„è©±ï¼Ÿ\u003C/h2>\u003Cp>è‹¥ä¸ä½¿ç”¨åŒ…è£å™¨ï¼Œåœ¨ Telegram Bot API ä¸­æ‰€æœ‰çš„æ“ä½œï¼Œä¸è«–æ˜¯ \u003Cstrong>[æ¥æ”¶è³‡è¨Š]\u003C/strong> é‚„æ˜¯ \u003Cstrong>[ç™¼é€è¨Šæ¯]\u003C/strong> éƒ½æ˜¯é€é HTTP API ä¾†é€²è¡Œã€‚çµæ§‹å¦‚ä¸‹ï¼š\u003C/p>\\n\u003Cpre>\u003Ccode class=\\\"language-text\\\">https://api.telegram.org/bot{BOT_TOKEN}/{METHOD_NAME}\\n\u003C/code>\u003C/pre>\\n\u003Cul>\\n\u003Cli>\u003Ccode>BOT_TOKEN\u003C/code> -&gt; å¾ BotFather å–å¾—çš„ Token String \u003C/li>\\n\u003Cli>\u003Ccode>METHOD_NAME\u003C/code> -&gt; å°æ‡‰çš„æ–¹æ³•åç¨±ï¼Œå¦‚ï¼šgetMeã€getUpdates\u003C/li>\\n\u003C/ul>\\n\u003Cp>æ”¯æ´ GET èˆ‡ POST çš„æ“ä½œï¼Œæ„å‘³è‘—å°æ–¼ç°¡å–®çš„è¨Šæ¯å¯ä»¥ç›´æ¥ä½¿ç”¨ç€è¦½å™¨è¼¸å…¥ Url QueryParamsã€‚\u003C/p>\\n\u003Cpre>\u003Ccode class=\\\"language-text\\\">https://api.telegram.org/bot{BOT_TOKEN}/{METHOD_NAME}?url={API_URL}\\n\u003C/code>\u003C/pre>\\n\u003Cp>é‡å°è¤‡é›œçš„æ“ä½œå¯ä»¥é€é POST ä¸¦å¤¾å¸¶æ–¼ Body ä¸­ã€‚æ”¯æ´çš„ Content-Typeï¼š\u003C/p>\\n\u003Cul>\\n\u003Cli>\u003Ccode>application/x-www-form-urlencoded\u003C/code>\u003C/li>\\n\u003Cli>\u003Ccode>application/json (except for uploading files)\u003C/code>\u003C/li>\\n\u003Cli>\u003Ccode>multipart/form-data (use to upload files)\u003C/code>\u003C/li>\\n\u003C/ul>\\n\u003Cp>ä»¥ GetUpdates ç‚ºä¾‹ï¼Œé€éå‘¼å« APIï¼š\\n\u003Ccode>https://api.telegram.org/bot{BOT_TOKEN}/getUpdates\u003C/code>\u003C/p>\\n\u003Cp>æœ€å¾Œç²å¾—çš„ responseï¼š\u003C/p>\\n\u003Cpre>\u003Ccode class=\\\"language-js\\\">{\\n  &quot;ok&quot;:true,\\n  &quot;result&quot;:[\\n    {\\n      &quot;update_id&quot;:136940592,\\n      &quot;message&quot;:{\\n        &quot;message_id&quot;:964,\\n        &quot;from&quot;:{\\n          &quot;id&quot;:549919258,\\n          &quot;is_bot&quot;:false,\\n          &quot;first_name&quot;:&quot;Ch.&quot;,\\n          &quot;last_name&quot;:&quot;S&quot;,\\n          &quot;username&quot;:&quot;Saweima&quot;\\n        },\\n        &quot;chat&quot;:{\\n          &quot;id&quot;:-1001756617092,\\n          &quot;title&quot;:&quot;T1 Group&quot;,\\n          &quot;type&quot;:&quot;supergroup&quot;\\n        },\\n        &quot;date&quot;:1657095304,\\n        &quot;text&quot;:&quot;test&quot;\\n      }\\n    }\\n  ]\\n}\\n\u003C/code>\u003C/pre>\\n\u003Cp>åœ¨ä¸ä½¿ç”¨åŒ…è£å™¨çš„æƒ…æ³ä¸‹ï¼Œéœ€è¦è‡ªå·±çµ„åˆå‡ºå°æ‡‰çš„ API URL å‘¼å«ï¼Œä¸¦ä¸”è‡ªå·±è™•ç†å›å‚³çš„ messageã€‚ é€™äº›æ˜¯åŒ…è£å™¨ä¸»è¦ç¯€çœçš„éƒ¨ä»½ã€‚\u003C/p>\\n\u003Ch2 id=\\\"æ³¨æ„äº‹é …\\\" class=\\\"heading-item\\\">æ³¨æ„äº‹é …\u003C/h2>\u003Cul>\\n\u003Cli>éƒ¨ä»½æ©Ÿå™¨äººçš„æ“ä½œï¼ˆå¦‚ï¼šåˆªé™¤å…¶ä»–äººè¨Šæ¯ã€è¨­å®šæ¬Šé™...ç­‰ï¼‰éœ€è¦æœ‰å°æ‡‰çš„ç¾¤çµ„æ¬Šé™ã€‚\u003C/li>\\n\u003Cli>éç¾¤çµ„ç®¡ç†å“¡çš„æ©Ÿå™¨äººï¼Œåªåœ¨é‡åˆ°è‡ªå·±ç™»è¨˜éçš„æŒ‡ä»¤æ‰æœƒæ”¶åˆ°ç›¸é—œè¨Šæ¯ã€‚\u003C/li>\\n\u003Cli>è‹¥ç‚ºç¾¤çµ„ç®¡ç†å“¡çš„æ©Ÿå™¨äººï¼Œæœƒæ¥æ”¶åˆ°è©²ç¾¤çµ„å…§çš„æ‰€æœ‰è¨Šæ¯ã€‚\u003C/li>\\n\u003Cli>è‹¥ä¸€å‰‡è¨Šæ¯åœ¨ Telegram ä¼ºæœå™¨ç™¼é€çµ¦æ©Ÿå™¨äººä¹‹å‰è¢«åˆªé™¤ï¼Œå‰‡æ©Ÿå™¨äººæœƒæ”¶ä¸åˆ°è©²å‰‡è¨Šæ¯ã€‚\u003C/li>\\n\u003Cli>Telegram è¶…é 500 äººçš„ç¾¤çµ„æœ‰å¯èƒ½æ”¶ä¸åˆ° Join Messageã€‚\u003C/li>\\n\u003Cli>æ©Ÿå™¨äººä¹‹é–“æœƒäº’ç›¸å¹²æ“¾ï¼Œå¿…é ˆç¢ºä¿æ©Ÿå™¨äººç”¢ç”Ÿçš„å°è©±å…§å®¹ã€æ¥æ”¶çš„æŒ‡ä»¤ä¸æœƒè§¸ç™¼å…¶ä»–æ©Ÿå™¨äººã€‚\u003C/li>\\n\u003C/ul>\\n\u003Ch2 id=\\\"tldr\\\" class=\\\"heading-item\\\">TL;DR\u003C/h2>\u003Cul>\\n\u003Cli>AIOGram æ˜¯ Telegram Bot API çš„åŒ…è£å™¨ï¼Œç”¨ä»¥ç°¡åŒ–æ©Ÿå™¨äººé–‹ç™¼æµç¨‹ã€‚\u003C/li>\\n\u003Cli>AIOGram æ”¯æ´\u003Cstrong>è¼ªè©¢æŠ“å–æ›´æ–° - Polling\u003C/strong> åŠ\u003Cstrong>è¢«å‹•æ¥æ”¶æ›´æ–° - Webhook\u003C/strong>ã€‚\u003C/li>\\n\u003Cli>æ¨è–¦ä½¿ç”¨ Webhook ä½œç‚ºæ¥æ”¶æ›´æ–°çš„æ–¹å¼ï¼Œç”¨ä»¥ç¯€çœæµé‡èˆ‡é‹ç®—è³‡æºã€‚\u003C/li>\\n\u003Cli>ä½¿ç”¨ Webhook æ¥æ”¶æ›´æ–°éœ€è¦æœ‰æ”¯æ´ https çš„ domainã€‚\u003C/li>\\n\u003Cli>å¯ä»¥é€é Ngrok çš„åå‘ä»£ç†ï¼Œæ¸¬è©¦æœ¬æ©Ÿç«¯çš„ Webhook èˆ‡ API ã€‚\u003C/li>\\n\u003Cli>è‹¥ä¸ä½¿ç”¨åŒ…è£å™¨ï¼Œå‰‡éœ€è¦è‡ªå·±çµ„åˆå‡º HTTP URL åŠè‡ªè¡Œè™•ç†è¨Šæ¯çš„è§£æã€‚\u003C/li>\\n\u003C/ul>\\n\",\"headings\":[{\"depth\":2,\"text\":\"AIOGram\",\"id\":\"aiogram\"},{\"depth\":2,\"text\":\"è¨»å†Š Telegram Bot\",\"id\":\"è¨»å†Š-telegram-bot\"},{\"depth\":2,\"text\":\"å»ºç«‹åŸºæœ¬çµæ§‹\",\"id\":\"å»ºç«‹åŸºæœ¬çµæ§‹\"},{\"depth\":3,\"text\":\"ä½¿ç”¨ Polling\",\"id\":\"ä½¿ç”¨-polling\"},{\"depth\":3,\"text\":\"ä½¿ç”¨ Webhook\",\"id\":\"ä½¿ç”¨-webhook\"},{\"depth\":2,\"text\":\"å¦‚ä½•åœ¨æœ¬åœ°ç«¯é€²è¡Œæ¸¬è©¦ï¼Ÿ\",\"id\":\"å¦‚ä½•åœ¨æœ¬åœ°ç«¯é€²è¡Œæ¸¬è©¦ï¼Ÿ\"},{\"depth\":3,\"text\":\"Ngrok\",\"id\":\"ngrok\"},{\"depth\":2,\"text\":\"å¦‚æœä¸ä½¿ç”¨åŒ…è£å™¨çš„è©±ï¼Ÿ\",\"id\":\"å¦‚æœä¸ä½¿ç”¨åŒ…è£å™¨çš„è©±ï¼Ÿ\"},{\"depth\":2,\"text\":\"æ³¨æ„äº‹é …\",\"id\":\"æ³¨æ„äº‹é …\"},{\"depth\":2,\"text\":\"TL;DR\",\"id\":\"tldr\"}]}"}</script></div>
	</body>
</html>
